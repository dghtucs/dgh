risk

## 算法思路和实现要点

用单调队列（Max Queue）在一次线性扫描中求出每天“向前 (m_i) 天（不含当天）”的最大值 (K_i)。具体做法：按天递增遍历，窗口左端为 (L=i-m_i)。先把队首（保存的是下标）凡是小于 (L) 的弹出；此时队首值即为窗口最大值，若队列为空则 (K_i=0)。随后将当天 (x_i) 入队：从队尾删去所有不大于 (x_i) 的元素，再压入 ((i,x_i))。同时用计数数组对每个 (K_i) 计数。扫描结束对计数做前缀和；


## 渐进时间复杂度的分析，包含过程

每个下标仅在单调队列中入队一次、出队至多一次，故整段“滑窗求最大值”是 (O(n))。当问题规模（天数与查询数）趋大时，整体耗时呈线性增长。

## 渐进空间复杂度的分析，包含过程


辅助空间包含：单调队列的两个数组（下标与值）大小均为 (O(n))；统计 (K_i) 的计数数组及其原地前缀和为 (O(\mathrm{maxX}))。因此总辅助空间复杂度为
[
S(n)=O\big(n+\mathrm{maxX}\big).
]


## 遇到的困难和解决方法

* 窗口边界易错：题意为“前 (m_i) 天，不含当天”，实现时先取最大值再入队当天，或严格用下标维护窗口为 ([i-m_i,,i-1])。
* `m_i` 为无符号 32 位，计算 (L=i-m_i) 需转为 64 位避免下溢。
* 查询阈值可能超过 (\mathrm{maxX})，前缀和下标需截断到 (\mathrm{maxX})。


## 估计完成本题所用时间

1.5 小时


