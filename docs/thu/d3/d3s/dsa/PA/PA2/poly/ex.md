## 算法思路和实现要点

本题要求对输入的多项式表达式进行解析和计算，最终输出多项式的系数。为了实现这一功能，我采用了递归下降解析器（Recursive Descent Parser）的方式，对表达式进行逐层解析。

主要的实现要点包括：

1. 递归下降解析：将表达式解析分为 `parseExpression`、`parseTerm`、`parseFactor`、`parseBase` 四个递归函数，分别处理加减、乘法、指数和基本元素（数字、变量、括号）。

2. 处理隐式乘法：在解析项（Term）时，除了显式的乘号 `*`，还需要识别诸如 `2x`、`(x+1)(x-1)` 这种省略乘号的情况。

3. 多项式的表示与运算：使用结构体 `Polynomial` 来表示多项式，包含一个系数数组 `coef`。实现了多项式的加法、减法、乘法和幂运算（指数不超过 4）。

4. 模运算处理：所有的计算都在取模 `M = 1e9 + 7` 的情况下进行，防止整数溢出。

5. 输入处理：由于输入可能包含大量字符，采用字符数组 `input` 存储，并通过全局变量 `pos` 维护当前解析位置。

## 渐进时间复杂度的分析，包含过程

设输入表达式的长度为 `n`。

1. 解析过程：在最坏情况下，每个字符都需要被解析一次，递归调用的深度取决于表达式的嵌套层数。由于递归函数之间的调用是线性的，故解析的时间复杂度为 `O(n)`。

2. 多项式运算：多项式的加法和减法在 `O(MAX_DEG)` 时间内完成，乘法和幂运算的复杂度为 `O(MAX_DEG^2)`，其中 `MAX_DEG` 为多项式的最大次数（65）。由于指数最大为 4，且多项式次数有限，故这些运算的时间复杂度视为常数。

3. 总体时间复杂度：综合以上，由于 `MAX_DEG` 为常数，故整体时间复杂度为 `O(n)`。

## 渐进空间复杂度的分析，包含过程

1. 输入存储：使用了长度为 `n` 的字符数组 `input` 来存储输入，空间复杂度为 `O(n)`。

2. 多项式表示：`Polynomial` 结构体包含一个长度为 `MAX_DEG` 的系数数组，空间复杂度为 `O(MAX_DEG)`。

3. 递归调用栈：递归深度取决于表达式的嵌套层数，最坏情况下可能达到 `O(n)`，因此递归调用栈的空间复杂度为 `O(n)`。

4. 总体空间复杂度：主要由输入存储和递归调用栈决定，故整体空间复杂度为 `O(n)`。

## 遇到的困难和解决方法

困难：

- 递归深度过大导致栈溢出：在测试用例 5 和 9 中，由于输入表达式过长或嵌套层数过深，递归调用栈溢出，导致运行时错误（signal 11）。

解决方法：

- 改用迭代解析器：为了避免递归带来的栈溢出问题，可以将递归下降解析器改为迭代式解析器，例如使用 算符优先分析法 或 逆波兰表达式（RPN）。

- 使用堆栈模拟递归：在不改变整体解析逻辑的情况下，使用显式的堆栈来模拟递归过程，控制调用深度。

- 优化解析策略：简化解析过程，减少不必要的函数调用和递归深度。

## 估计完成本题所用时间 

6 小时

