
# åŠ¨æ€è§„åˆ’ï¼šçº¿æ€§ & åŒºé—´åŠ¨æ€

ç†è§£åŠ¨æ€è§„åˆ’çš„åŸºæœ¬æ€æƒ³
äº†è§£åŠ¨æ€è§„åˆ’ç®—æ³•çš„ä¼˜ç¼ºç‚¹å’Œé—®é¢˜åˆ†ç±»
æŒæ¡è¿ç”¨åŠ¨æ€è§„åˆ’è§£å†³é—®é¢˜çš„æ€è·¯
èƒ½å¤Ÿè¿ç”¨åŠ¨æ€è§„åˆ’è§£å†³çº¿æ€§ã€å‰ç¼€å’Œã€åŒºé—´è¿™ä¸‰ç±»é—®é¢˜


## ç®€ä»‹

![Alt text](image.png)

![Alt text](image-1.png)


![Alt text](image-2.png)


![Alt text](image-3.png)

![Alt text](image-4.png)


![Alt text](image-5.png)

![Alt text](image-6.png)


## çº¿æ€§åŠ¨æ€è§„åˆ’


![Alt text](image-7.png)

![Alt text](image-8.png)


### å•ä¸²

![Alt text](image-9.png)

![Alt text](image-10.png)

![Alt text](image-11.png)
![Alt text](image-12.png)

![Alt text](image-13.png)
![Alt text](image-14.png)
![Alt text](image-15.png)


### å¸¦ç»´åº¦å•ä¸² dp[i][k]

![Alt text](image-16.png)
![Alt text](image-17.png)
![Alt text](image-18.png)

### åŒä¸²

![Alt text](image-19.png)
![Alt text](image-20.png)
![Alt text](image-21.png)
![Alt text](image-22.png)
![Alt text](image-23.png)


### çŸ©é˜µ

![Alt text](image-24.png)
![Alt text](image-25.png)
çŸ©é˜µç›¸å…³ç»ƒä¹ é¢˜
çŸ©é˜µ dp[i][j]
çŸ©é˜µ dp[i][j][k]


çº¿æ€§åŠ¨æ€è§„åˆ’æ˜¯åŠ¨æ€è§„åˆ’ä¸­æœ€åŸºç¡€çš„ä¸€ç±»ï¼Œå®ƒçš„çŠ¶æ€ä¸€èˆ¬ç‰©ç†æ„ä¹‰å¾ˆæ˜ç¡®ï¼Œæ˜“äºåˆ†æã€‚åœ¨åˆå­¦åŠ¨æ€è§„åˆ’æ—¶ï¼Œé€šè¿‡çº¿æ€§åŠ¨æ€è§„åˆ’çš„å¤§é‡ç»ƒä¹ ï¼Œå¯ä»¥ä¸æ–­åŠ æ·±åŠ¨æ€è§„åˆ’çš„æ¦‚å¿µç†è§£ï¼Œä¾‹å¦‚åŠ¨æ€è§„åˆ’ä¸­æœ€é‡è¦çš„ä¸‰ä¸ªæ¦‚å¿µï¼šæœ€ä¼˜å­ç»“æ„ï¼Œé‡å¤å­é—®é¢˜ï¼Œæ— åæ•ˆæ€§ã€‚ä¸‹é¢å¯¹åŠ¨æ€è§„åˆ’çš„ä¸‰ä¸ªåŸºæœ¬æ¦‚å¿µåšä¸ªç®€è¦å›é¡¾ï¼Œåœ¨çº¿æ€§åŠ¨æ€è§„åˆ’çš„é¢˜ç›®ç»ƒä¹ ä¸­å¯ä»¥ä¸æ–­åœ°åŠ æ·±ç†è§£ï¼Œä¹‹åå†å­¦ä¹ å…¶å®ƒçš„åŠ¨æ€è§„åˆ’ç±»å‹å°±ä¼šå®¹æ˜“å¾ˆå¤šã€‚

æœ€ä¼˜å­ç»“æ„ï¼šå¦‚æœé—®é¢˜çš„æœ€ä¼˜è§£æ‰€åŒ…å«çš„å­é—®é¢˜çš„è§£ä¹Ÿæ˜¯æœ€ä¼˜çš„ï¼Œå°±ç§°è¯¥é—®é¢˜å…·æœ‰æœ€ä¼˜å­ç»“æ„ã€‚
æ— åæ•ˆæ€§ï¼šå³æŸé˜¶æ®µçŠ¶æ€ä¸€æ—¦ç¡®å®šï¼Œå°±ä¸å—è¿™ä¸ªçŠ¶æ€ä»¥åå†³ç­–çš„å½±å“ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒæŸçŠ¶æ€ä»¥åçš„è¿‡ç¨‹ä¸ä¼šå½±å“ä»¥å‰çš„çŠ¶æ€ï¼Œåªä¸å½“å‰çŠ¶æ€æœ‰å…³ã€‚
é‡å¤å­é—®é¢˜ï¼šå³å­é—®é¢˜ä¹‹é—´æ˜¯ä¸ç‹¬ç«‹çš„ï¼Œä¸€ä¸ªå­é—®é¢˜åœ¨ä¸‹ä¸€é˜¶æ®µå†³ç­–ä¸­å¯èƒ½è¢«å¤šæ¬¡ä½¿ç”¨åˆ°ã€‚ï¼ˆè¯¥æ€§è´¨å¹¶ä¸æ˜¯åŠ¨æ€è§„åˆ’é€‚ç”¨çš„å¿…è¦æ¡ä»¶ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰è¿™æ¡æ€§è´¨ï¼ŒåŠ¨æ€è§„åˆ’ç®—æ³•åŒå…¶ä»–ç®—æ³•ç›¸æ¯”å°±ä¸å…·å¤‡ä¼˜åŠ¿ï¼‰
çº¿æ€§åŠ¨æ€è§„åˆ’æ˜¯åŠ¨æ€è§„åˆ’ä¸­å˜åŒ–æœ€å¤šçš„ä¸€ç±»ã€‚

é¦–å…ˆçº¿æ€§åŠ¨æ€è§„åˆ’é’ˆå¯¹çš„é—®é¢˜æ˜¯æœ€å¸¸è§çš„æ•°ç»„ï¼Œå­—ç¬¦ä¸²ï¼ŒçŸ©é˜µç­‰ï¼Œè¿™ä¸‰ç§æ•°æ®ç»“æ„æœ¬èº«å°±æ˜¯çº¿æ€§çš„ï¼Œå› æ­¤å‡ºç°è¿™äº›ç±»å‹çš„è¾“å…¥çš„æ—¶å€™ï¼Œå¦‚æœè¦ç”¨åˆ°åŠ¨æ€è§„åˆ’ï¼Œé¦–å…ˆè€ƒè™‘çº¿æ€§åŠ¨æ€è§„åˆ’å°±å¾ˆåˆç†äº†ï¼Œå› æ­¤å¾ˆå¤šé—®é¢˜ä¸è®ºæœ€åæ­£è§£æ˜¯ä¸æ˜¯çº¿æ€§åŠ¨æ€è§„åˆ’ï¼Œéƒ½ä¼šé¦–å…ˆæƒ³ä¸€ä¸‹çº¿æ€§åŠ¨æ€è§„åˆ’æ˜¯å¦å¯è¡Œã€‚

å…¶æ¬¡ç”±äºå¤§éƒ¨åˆ†é—®é¢˜çš„æ•°æ®éƒ½æ˜¯ä»¥è¿™ä¸‰ç§å½¢å¼ç»™å‡ºçš„ï¼Œå› æ­¤é¢˜ç›®çš„å˜åŒ–ä¼šéå¸¸å¤šï¼Œå¾ˆå¤šå¸¸è§çš„è¾“å…¥å½¢å¼ä»¥åŠé—®é¢˜éƒ½éå¸¸ç»å…¸ï¼Œéƒ½å­˜åœ¨ç»å…¸çš„çŠ¶æ€è®¾è®¡ã€‚å› æ­¤ä¸è€ƒè™‘ä¸€äº›æ¯”è¾ƒ Trick çš„è§£æ³•ï¼Œä»…ä»…æ˜¯ç»å…¸é—®é¢˜çš„ç»å…¸çŠ¶æ€è®¾è®¡ï¼Œå°±æ¯”å…¶å®ƒç§ç±»çš„åŠ¨æ€è§„åˆ’é—®é¢˜å¤šå¾ˆå¤šäº†ã€‚

ä¾‹å¦‚å•ä¸ªæ•°ç»„æˆ–å­—ç¬¦ä¸²ä¸Šè®¾è®¡ä¸€ç»´çŠ¶æ€ï¼Œä¸¤ä¸ªæ•°ç»„æˆ–å­—ç¬¦ä¸²ä¸Šè®¾è®¡ä¸¤ç»´çŠ¶æ€ï¼Œä»¥åŠçŸ©é˜µä¸Šè®¾è®¡ä¸¤ç»´çŠ¶æ€ç­‰ç­‰ï¼ŒåŒæ—¶ä»¥ä¸Šä¸‰ç§æƒ…å†µçš„çŠ¶æ€è®¾è®¡éƒ½æœ‰å¯èƒ½å†åŠ ä¸Šé¢å¤–çš„æŒ‡æ ‡çš„çŠ¶æ€ï¼Œå°±æ˜¯å‰é¢ä¾‹é¢˜ä¸­çš„ kï¼Œè¿™é‡Œé¢å˜åŒ–å°±å¾ˆå¤šäº†ï¼Œæ¯”å¦‚æœ‰çš„é¢˜ç›®åœ¨ k è¿™ä¸€ç»´ä¸Šè¦ä½¿ç”¨äºŒåˆ†ï¼Œè´ªå¿ƒçš„ç­–ç•¥ï¼Œæœ‰çš„é¢˜ç›®éœ€è¦ DP çŠ¶æ€ä¸æ•°æ®ç»“æ„é…åˆæ¥è§£å†³é—®é¢˜ã€‚

é™¤æ­¤ä¹‹å¤–è¿˜æœ‰ä¸€ç±»é—®é¢˜æ²¡æœ‰æ˜¾å¼çš„æ•°ç»„ï¼Œå­—ç¬¦ä¸²ï¼Œä½†æ˜¯åœ¨æ±‚è§£çš„æ—¶å€™ä¾ç„¶æ»¡è¶³å‰é¢æåˆ°çš„åŠ¨æ€è§„åˆ’ä¸‰æ¡åŸºæœ¬æ¦‚å¿µï¼Œå¯ä»¥ç”¨åŠ¨æ€è§„åˆ’æ±‚è§£ï¼Œè¿™ç§é—®é¢˜é€šå¸¸ä¹Ÿæ˜¯çº¿æ€§åŠ¨æ€è§„åˆ’ã€‚å¦‚æ­¤å¤šçš„å˜åŒ–ä»…ä»…æœ¬å°èŠ‚ä¾‹ä¸¾çš„é¢˜ç›®æ˜¯è¿œè¿œä¸å¤Ÿçš„ï¼Œä¸‹ä¸€å°èŠ‚æ˜¯çº¿æ€§åŠ¨æ€è§„åˆ’çš„ç»ƒä¹ é¢˜ï¼Œæ¶‰åŠåˆ°å¯¹çº¿æ€§åŠ¨æ€è§„åˆ’çš„æ›´å¤šçš„å˜åŒ–ã€‚

## å‰ç¼€å’Œ

å‰ç¼€å’Œæ˜¯ä¸€ç§æŸ¥è¯¢æ•°ç»„ä¸­ä»»æ„åŒºé—´çš„å…ƒç´ çš„å’Œçš„æ•°æ®ç»“æ„ï¼Œè¿™é‡Œæ•°ç»„ç»™å®šä¹‹åå°±ä¸å˜äº†ã€‚é’ˆå¯¹è¿™ä¸ªä¸å˜çš„æ•°ç»„ï¼Œå‰ç¼€å’Œç”¨äºå¤šæ¬¡æŸ¥è¯¢åŒºé—´ [i, j] ä¸Šå…ƒç´ çš„å’Œã€‚

å¯¹äºåŠ¨æ€è§„åˆ’è€Œè¨€ï¼Œå‰ç¼€å’Œçš„æ„ä¹‰ä¸»è¦æœ‰ä¸¤ç‚¹ï¼š

ä¸€ç»´å’ŒäºŒç»´å‰ç¼€å’Œçš„æ¨å¯¼ï¼Œåˆ†åˆ«ç”¨åˆ°äº†å•ä¸²å’ŒçŸ©é˜µä¸­æœ€ç»å…¸çš„çŠ¶æ€è®¾è®¡ä»¥åŠçŠ¶æ€è½¬ç§»ï¼›
åœ¨ä¸€äº›æ›´å¤æ‚çš„åŠ¨æ€è§„åˆ’é—®é¢˜ä¸­ï¼ŒçŠ¶æ€è½¬ç§»çš„æ—¶å€™éœ€è¦ä¾èµ–åŒºé—´å’Œï¼Œå› ä¸ºçŠ¶æ€è½¬ç§»æ˜¯éå¸¸é¢‘ç¹çš„æ“ä½œï¼Œå› æ­¤å¿…é¡»é«˜æ•ˆåœ°æ±‚åŒºé—´å’Œæ‰èƒ½ä½¿å¾—çŠ¶æ€è½¬ç§»çš„æ—¶é—´å¤æ‚åº¦å¯æ¥å—ï¼Œæ­¤æ—¶å°±å¿…é¡»ç”¨åˆ°å‰ç¼€å’Œäº†ã€‚
é™¤æ­¤ä¹‹å¤–ï¼Œä¸€äº›é—®é¢˜éœ€è¦å‰ç¼€å’Œä¸å…¶å®ƒæ•°æ®ç»“æ„é…åˆæ¥è§£å†³ï¼Œä¹Ÿæœ‰ä¸¤ç±»ï¼š

å…ˆé¢„å¤„ç†å‡ºå‰ç¼€å’Œæ•°ç»„ï¼Œè¿™ä¸€æ­¥æ˜¯åŠ¨æ€è§„åˆ’ï¼Œç„¶ååœ¨å‰ç¼€å’Œæ•°ç»„ä¸Šç”¨å…¶å®ƒæ•°æ®ç»“æ„è§£å†³ï¼›
è¿˜æ˜¯æŒ‰ç…§åŠ¨æ€è§„åˆ’çš„æ–¹å¼æ±‚å‰ç¼€å’Œï¼Œä¹Ÿéœ€è¦é¢å¤–çš„æ•°æ®ç»“æ„ç»´æŠ¤å‰ç¼€å’Œï¼Œä½†ä¸æ˜¯é¢„å¤„ç†å¥½å‰ç¼€å’Œæ•°ç»„ä¹‹åå†ç”¨æ•°æ®ç»“æ„è®¡ç®—ï¼Œè€Œæ˜¯æ¯æ±‚å‡ºä¸€ä¸ªå‰ç¼€å’Œï¼Œå°±æ›´æ–°ä¸€æ¬¡æ•°æ®ç»“æ„å¹¶ç»´æŠ¤ç­”æ¡ˆã€‚
å‰ç¼€å’Œçš„æ¨å¯¼å’Œè®¡ç®—éšå«ç€åŠ¨æ€è§„åˆ’çš„åŸºæœ¬æ€æƒ³ï¼ŒåŒæ—¶å®ƒçš„çŠ¶æ€è®¾è®¡æ˜¯çº¿æ€§åŠ¨æ€è§„åˆ’ä¸­æ¯”è¾ƒç®€å•çš„é‚£ä¸€ç±»ã€‚ä¸çº¿æ€§åŠ¨æ€è§„åˆ’ä¸€æ ·ï¼Œå‰ç¼€å’Œä¹Ÿæœ‰ä¸€ç»´å’ŒäºŒç»´ä¸¤ç§åœºæ™¯ã€‚
è™½ç„¶å‰ç¼€å’Œæœ¬èº«å¾ˆç®€å•ï¼Œä½†éœ€è¦ç”¨åˆ°å®ƒè§£å†³çš„é—®é¢˜éå¸¸å¤šï¼Œä¸å…¶å®ƒæ•°æ®ç»“æ„é…åˆçš„å˜åŒ–ä¹Ÿå¾ˆå¤šï¼Œå› æ­¤éœ€è¦ä»çº¿æ€§åŠ¨æ€è§„åˆ’ä¸­å‰¥ç¦»å‡ºæ¥å•ç‹¬å­¦ä¹ ã€‚

### æ±‚åŒºé—´å’Œ

![Alt text](image-26.png)

![Alt text](image-27.png)

![Alt text](image-28.png)

![Alt text](image-29.png)

### æ•°æ®ç»“æ„ç»´æŠ¤å‰ç¼€å’Œ

![Alt text](image-30.png)

![Alt text](image-31.png)

### è¿ç®—æ¨å¹¿

![Alt text](image-32.png)


### å·®åˆ†
![Alt text](image-33.png)


## åŒºé—´åŠ¨æ€è§„åˆ’
åœ¨è¾“å…¥ä¸ºé•¿åº¦ä¸º n çš„æ•°ç»„æ—¶ï¼Œå­é—®é¢˜ç”¨åŒºé—´ [i..j] è¡¨ç¤ºã€‚
çŠ¶æ€çš„å®šä¹‰å’Œè½¬ç§»éƒ½ä¸åŒºé—´æœ‰å…³ï¼Œç§°ä¸ºåŒºé—´åŠ¨æ€è§„åˆ’

![Alt text](image-34.png)

![Alt text](image-35.png)

![Alt text](image-36.png)

![Alt text](image-37.png)

![Alt text](image-38.png)

![Alt text](image-39.png)

![Alt text](image-40.png)

# åŠ¨æ€è§„åˆ’ï¼šçŠ¶å‹ã€è®¡æ•° & æ•°ä½åŠ¨æ€

## èƒŒåŒ…åŠ¨æ€è§„åˆ’
![Alt text](image-41.png)


![Alt text](image-42.png)
![Alt text](image-43.png)
![Alt text](image-44.png)
![Alt text](image-45.png)
![Alt text](image-46.png)
![Alt text](image-47.png)
## çŠ¶æ€å‹ç¼©åŠ¨æ€è§„åˆ’

çŠ¶æ€å‹ç¼©åŠ¨æ€è§„åˆ’æ˜¯ä¸€ç±»éå¸¸å…¸å‹çš„åŠ¨æ€è§„åˆ’ï¼Œé€šå¸¸ä½¿ç”¨åœ¨ NP é—®é¢˜çš„å°è§„æ¨¡æ±‚è§£ä¸­ï¼Œè™½ç„¶æ˜¯æŒ‡æ•°çº§åˆ«çš„å¤æ‚åº¦ï¼Œä½†é€Ÿåº¦æ¯”æœç´¢å¿«ã€‚

![Alt text](image-48.png)
![Alt text](image-49.png)
![Alt text](image-50.png)
![Alt text](image-51.png)

## è®¡æ•°é—®é¢˜

åŠ¨æ€è§„åˆ’ä¸­çš„è®¡æ•°å‹é—®é¢˜å°±æ˜¯åˆ©ç”¨åŠ¨æ€è§„åˆ’çš„ç®—æ³•æ€æƒ³å»è®¡ç®—å‡ºè§£å†³è¿™ä¸ªé—®é¢˜æœ‰å¤šå°‘ç§æ–¹æ³•ã€‚
æ¯”å¦‚ï¼Œä»èµ·ç‚¹èµ°åˆ°ç»ˆç‚¹ï¼Œå¯ä»¥æœ‰å¤šå°‘æ¡è·¯å¾„ï¼Œæ³¨æ„ï¼Œæ˜¯å¤šå°‘æ¡ï¼Œè€Œä¸æ˜¯å…·ä½“è·¯çº¿çš„æè¿°ã€‚
å½“ç„¶ä¹Ÿæœ‰å…·ä½“æ¯ä¸€æ¡è·¯çº¿çš„é—®æ³•ï¼Œè¿™æ˜¯ dfs çš„é—®é¢˜äº†ã€‚

![Alt text](image-52.png)
![Alt text](image-53.png)
![Alt text](image-54.png)
è®¡æ•°é—®é¢˜ç›¸å…³ç»ƒä¹ é¢˜
è·¯å¾„é—®é¢˜
å¡ç‰¹å…°æ•°
é“ºç –é—®é¢˜
æ–æ³¢é‚£å¥‘
éšæ™¦çš„é€’æ¨å…³ç³»


## çŸ©é˜µå¿«é€Ÿå¹‚
æ˜¯ä¸€ç§åŸºç¡€ç®—æ³•ï¼Œæœ¬èº«ä¸åŠ¨æ€è§„åˆ’æ²¡æœ‰å…³ç³»ï¼Œä½†å®ƒå¯ä»¥ç”¨äºä¼˜åŒ–çº¿æ€§é€’æ¨å…³ç³»çš„è®¡ç®—ï¼Œå¹¶ä¸”å…¶æ€è·¯æ¯”è¾ƒå›ºå®šï¼Œå› æ­¤åœ¨è®¡æ•°é—®é¢˜ç« èŠ‚ä¹‹åï¼Œåœ¨æœ¬ç« å°†çŸ©é˜µå¿«é€Ÿå¹‚åšåŸºç¡€ä»‹ç»ã€‚

![Alt text](image-55.png)

![Alt text](image-56.png)
![Alt text](image-57.png)

```c
using ll = long long;
const int M = 2;

struct Ma
{
    int a[M][M];
    Ma()
    {
        memset(a, 0, sizeof(a));
    }

    void init() // å¤ä½ä¸ºå•ä½é˜µ
    {
        a[0][0] = a[1][1] = 1;
        a[0][1] = a[1][1] = 0;
    }

    Ma operator*(const Ma& B) const
    {
        Ma ans;
        for(int i = 0; i < M; ++i)
            for(int j = 0; j < M; ++j)
                for(int k = 0; k < M; ++k)
                    ans.a[i][j] += a[i][k] * B.a[k][j];
        return ans;
    }

    Ma operator^(int n) const
    {
        Ma ans;
        ans.init();
        Ma A = *this; // æ‹·è´ä¸€ä¸ªå‡ºæ¥ç”¨äºè‡ªä¹˜
        while(n)
        {
            if(n & 1)
                ans = ans * A;
            A = A * A;
            n >>= 1;
        }
        return ans;
    }
};


```
![Alt text](image-58.png)
åœ¨ä¸Šä¸€ç« ä¸­çš„ 16 é“ç»ƒä¹ é¢˜ä¸­ï¼Œéƒ¨åˆ†é¢˜ç›®çš„é€’æ¨å…³ç³»æ˜¯çº¿æ€§çš„ï¼Œè¿›è€Œå¯ä»¥ç”¨çŸ©é˜µå¿«é€Ÿå¹‚æ¥åšï¼Œå°è¯•åˆ¤æ–­å“ªäº›é¢˜ç›®å¯ä»¥ç”¨çŸ©é˜µå¿«é€Ÿå¹‚åšï¼Œå¹¶ç”¨çŸ©é˜µå¿«é€Ÿå¹‚è§£å†³è¿™äº›é—®é¢˜ï¼ŒåŠ æ·±å¯¹æœ¬èŠ‚çš„ç†è§£ã€‚

## æ•°ä½ DP 
åœ¨åŸºç¡€çš„åŠ¨æ€è§„åˆ’é—®é¢˜å½“ä¸­ç®—æ˜¯æ¯”è¾ƒéš¾çš„ä¸€ç±»ï¼Œå› ä¸ºæ•°ä½ DP çš„çŠ¶æ€çš„ç‰©ç†æ„ä¹‰ä¸å¤ªå¥½ç†è§£ã€‚å…¶å®ƒçš„åŠ¨æ€è§„åˆ’ï¼Œæ¯”å¦‚åŒºé—´ DP çŠ¶æ€çš„ç‰©ç†æ„ä¹‰å°±æ˜¯åŒºé—´ï¼ŒçŠ¶æ€å‹ç¼© DP ä¸­çŠ¶æ€çš„ç‰©ç†æ„ä¹‰å°±æ˜¯é›†åˆï¼Œè¿™éƒ½æ¯”è¾ƒå¥½ç†è§£ã€‚

ä½†æ˜¯æ•°ä½ DP æ¯”å…¶å®ƒ DP å¥½çš„ä¸€é¢æ˜¯æ•°ä½ DP çš„æ€ç»´ç›¸å¯¹æ¯”è¾ƒå›ºå®šã€‚ ä¸€ä¸ªæ˜¯è§£å†³çš„é—®é¢˜æ¨¡å¼æ¯”è¾ƒå›ºå®šï¼Œä¸€ä¸ªæ˜¯çŠ¶æ€è®¾è®¡ä¹Ÿæ¯”è¾ƒå›ºå®šï¼Œå› æ­¤å¯ä»¥é€šè¿‡ä¸€äº›å¸¸è§é—®é¢˜æŠŠæ•°ä½ DP çš„å¥—è·¯äº†è§£ä¸ªå¤§æ¦‚ã€‚

åŠ›æ‰£ä¸Šæœ‰å‡ é“æ•°ä½ DP çš„é¢˜ç›®ï¼Œé€šè¿‡è¿™äº›é¢˜ç›®æˆ‘ä»¬å¯ä»¥å¤§è‡´äº†è§£æ•°ä½ DP çš„æ€è€ƒè¿‡ç¨‹å’Œåšæ³•ã€‚

![Alt text](image-59.png)
![Alt text](image-60.png)
![Alt text](image-61.png)
```cpp
int getdp(int pos, int lim, const vector<int>& digits, const set<int>& num_set, vector<vector<int>>& dp)
{
    if(pos == -1) return 1;
    if(dp[pos][lim] != -1)
        return dp[pos][lim];
    dp[pos][lim] = 0;
    int up = lim ? digits[pos] : 9; // å½“å‰è¦æšä¸¾åˆ°çš„ä¸Šç•Œ
    for(int i: num_set) // æšä¸¾å½“å‰ä½æ‰€æœ‰å¯èƒ½æ•°å­—
    {
        if(i > up)
            break;
        dp[pos][lim] += getdp(pos - 1, lim && i == up, digits, num_set, dp); // æœ¬ä½è¢«é™åˆ¶ä¸”é€‰é¡¶åˆ°ä¸Šç•Œçš„æ•°å­—,ä¸‹ä¸€ä½æ‰è¢«é™åˆ¶
    }
    return dp[pos][lim];
}


```
å‰å¯¼é›¶çš„åˆ†æ
å¢åŠ  zero çŠ¶æ€, è¡¨ç¤ºé«˜ä½æ˜¯å¦æ˜¯å‰å¯¼é›¶ã€‚

å¦‚æœé«˜ä½é€‰äº†å‰å¯¼é›¶ï¼Œåˆ™å½“å‰ä½æ— é™åˆ¶ï¼Œä¸”è¿˜å¯ä»¥é€‰å‰å¯¼é›¶ã€‚
å¦‚æœé«˜ä½æ²¡æœ‰é€‰å‰å¯¼é›¶ä¸”æœªé¡¶åˆ°ä¸Šç•Œï¼Œåˆ™å½“å‰ä½åœ¨å¯é€‰æ•°å­—é›†åˆçš„èŒƒå›´å†…æ— é™åˆ¶ã€‚
å¦‚æœé«˜ä½é¡¶åˆ°äº†ä¸Šç•Œï¼Œåˆ™å½“å‰ä½çš„é€‰æ‹©è¢«é™åˆ¶ã€‚
åŠ›æ‰£ä¸Šæ•°ä½ DP çš„é¢˜ç›®ä¸å¤šï¼Œä¸‹ä¸€èŠ‚æä¾›äº† 9 é“ç»ƒä¹ é¢˜ï¼Œå¯ä»¥å·©å›ºæ•°ä½ DP çš„æ€ç»´æ–¹å¼ã€‚

# åŠ¨æ€è§„åˆ’ï¼šæ ‘å½¢ã€å›¾ä¸Šã€æ¦‚ç‡ & åšå¼ˆåŠ¨æ€

## 1 2æœŸå›é¡¾
![Alt text](image-62.png)

![Alt text](image-63.png)

![Alt text](image-64.png)

ã€Œå•ä¸² DPã€
å¯¹äºã€Œå•ä¸²çº¿æ€§ DPã€é—®é¢˜ï¼Œi æ˜¯å•ä¸² s ä¸Šçš„ä½ç½®ã€‚ä½œä¸ºé˜¶æ®µå…·æœ‰æ—¶é—´æˆ–è€…ä½ç½®ç­‰å«ä¹‰ã€‚æœ‰æ—¶åªæœ‰å•ä¸²ä¸Šçš„ä½ç½®ä¸è¶³ä»¥è¡¨ç¤ºçŠ¶æ€ï¼Œéœ€è¦åŒæ—¶é™„åŠ ä¸€ä¸ªç»´åº¦ kï¼Œä¸€èˆ¬ k æœ‰é•¿åº¦ã€ä¸ªæ•°ã€æ¬¡æ•°ã€é¢œè‰²ç­‰å«ä¹‰ã€‚å¦ï¼Œæ‰€é™„åŠ çš„ç»´åº¦æœ‰æ—¶å€™å¯ä»¥æ˜¯å¤šä¸ªï¼Œå¦‚ k1, k2, ...

![Alt text](image-65.png)

![Alt text](image-66.png)

![Alt text](image-67.png)
![Alt text](image-68.png)
![Alt text](image-69.png)
![Alt text](image-70.png)

![Alt text](image-71.png)
![Alt text](image-72.png)
![Alt text](image-73.png)

æœ¬ç« æˆ‘ä»¬ä»‹ç»ã€Œçº¿æ€§ DPã€ä¸­æ¯”è¾ƒé‡è¦ï¼ŒåŒæ—¶åœ¨å‰ä¸¤æœŸæ²¡æœ‰è¯¦ç»†ä»‹ç»çš„ä¸¤å—å†…å®¹ï¼Œä¸€ä¸ªæ˜¯æœ€é•¿ä¸Šå‡å­åºåˆ—ï¼Œä¸€ä¸ªæ˜¯ã€Œæ£‹ç›˜ DPã€ã€‚

åœ¨åŠ¨æ€è§„åˆ’ç²¾è®²ç¬¬ä¸€æœŸä¸­ï¼Œæˆ‘ä»¬æœ‰ä»‹ç»è¿‡æœ€é•¿ä¸Šå‡å­åºåˆ—é—®é¢˜å¹¶ç”¨åŠ¨æ€è§„åˆ’çš„æ–¹æ³•è¿›è¡Œè§£å†³ã€‚å®é™…ä¸Šæœ€é•¿ä¸Šå‡å­åºåˆ—è¿˜æœ‰å…¶å®ƒè§£æ³•ï¼Œä»¥åŠåŠ›æ‰£ä¸Šæœ‰å¾ˆå¤šæœ€é•¿ä¸Šå‡å­åºåˆ—çš„å˜ç§é—®é¢˜ä»¥åŠåŒ…è£…ä¹‹åçš„é—®é¢˜ã€‚æˆ‘ä»¬åœ¨è¿™ä¸€å°èŠ‚è¿›è¡Œä»‹ç»ã€‚

é¦–å…ˆæˆ‘ä»¬ä»‹ç»æœ€é•¿ä¸Šå‡å­åºåˆ—åŸºäºäºŒåˆ†çš„è§£æ³•ï¼Œè¿™æ˜¯ LIS é—®é¢˜çš„æœ€å¥½çš„è§£æ³•ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜æœ‰ç”¨çº¿æ®µæ ‘ä¼˜åŒ–DPçš„æ–¹å¼çš„è§£æ³•ï¼Œè¿™éƒ¨åˆ†åœ¨åŠ¨æ€è§„åˆ’ç²¾è®²ç¬¬å››æœŸå…³äºDPçš„ä¼˜åŒ–æ–¹æ³•ä¸­ä»‹ç»ã€‚

ç„¶åæˆ‘ä»¬ä»‹ç»æœ€é•¿ä¸Šå‡å­åºåˆ—çš„å˜å½¢é—®é¢˜ï¼Œä¸€ä¸ªæ˜¯æœ€é•¿ä¸Šå‡å­åºåˆ—ä¸ªæ•°ï¼Œä¸€ä¸ªæ˜¯æœ€é•¿ä¸Šå‡å­ä¸²ã€‚

ç„¶åæˆ‘ä»¬ä»‹ç»ä¸€äº›åŠ›æ‰£ä¸Šçš„ä¸€äº›å¤šç»´å±æ€§çš„æœ€é•¿ä¸Šå‡å­åºåˆ—é—®é¢˜ã€‚

æœ€åæˆ‘é—¨ä»‹ç»éœ€è¦è‡ªå®šä¹‰ LIS ä¸­çš„å°äºçš„ä¸€äº›é—®é¢˜ï¼Œè¿™äº›é—®é¢˜åªè¦èƒ½æ­£ç¡®å®šä¹‰å°äºï¼Œå°±å¯ä»¥è½¬æ¢æˆæœ€é•¿ä¸Šå‡å­åºåˆ—é—®é¢˜ã€‚



åœ¨åŠ¨æ€è§„åˆ’ç²¾è®²ç¬¬ä¸€æœŸä¸­ï¼Œæˆ‘ä»¬æœ‰ä»‹ç»è¿‡åœ¨çŸ©é˜µä¸Šè¿›è¡Œçº¿æ€§æ¨å¯¼çš„åŠ¨æ€è§„åˆ’é—®é¢˜ï¼Œä½†æ˜¯æ²¡æœ‰ç³»ç»Ÿåœ°ä»‹ç»ï¼Œæœ¬å°èŠ‚å°†è¿™ä¸ªçŸ¥è¯†ç‚¹è¡¥å……ä¸€ä¸‹ã€‚

ã€Œæ£‹ç›˜ DPã€æ˜¯ä¸€ç§åœ¨çŸ©é˜µä¸Šè¿›è¡ŒçŠ¶æ€æ¨å¯¼çš„åŠ¨æ€è§„åˆ’é—®é¢˜ã€‚i, j åˆ†åˆ«æ˜¯æ£‹ç›˜(çŸ©é˜µ)çš„æ¨ªçºµåæ ‡ï¼Œä½†å¹¶ä¸ä¸€å®šè¦å…±åŒä½œä¸ºé˜¶æ®µã€‚é˜¶æ®µåˆ’åˆ†æœ‰ä¸¤ç§æƒ…å†µéƒ½æ¯”è¾ƒå¸¸è§ï¼š

ä»… i ä½œä¸ºé˜¶æ®µï¼Œå…·æœ‰ä½ç½®ç­‰å«ä¹‰ã€‚åŒæ—¶ j æ˜¯é™„åŠ çŠ¶æ€ã€‚
i, j å…±åŒä½œä¸ºé˜¶æ®µï¼Œå…·æœ‰ä½ç½®ç­‰å«ä¹‰ã€‚æ²¡æœ‰é™„åŠ ç»´åº¦ã€‚
è¿™ä¸¤ç§é˜¶æ®µåˆ’åˆ†æ–¹å¼çš„æ€è·¯æœ‰åŒºåˆ«ï¼Œç¬¬ä¸€ç§æ˜¯ä¸€è¡Œä¸€è¡Œåœ°è€ƒè™‘ï¼Œç¬¬äºŒç§æ˜¯ä¸€ä¸ªä½ç½®ä¸€ä¸ªä½ç½®åœ°è€ƒè™‘ã€‚

## æ ‘å½¢åŠ¨æ€è§„åˆ’
![Alt text](image-74.png)

![Alt text](image-75.png)
![Alt text](image-76.png)
![Alt text](image-77.png)
æ³¨æ„åˆ°åœ¨èŠ‚ç‚¹ u æ—¶ï¼ŒçŠ¶æ€è½¬ç§»è¿‡ç¨‹åªéœ€è¦ dp[v][0]ï¼Œè€Œä¸éœ€è¦ dp[v][1]ï¼Œå› æ­¤ dfs ä»…è¿”å› dp[v][0] å³å¯ã€‚

ä»£ç ä¸­ max1 è¡¨ç¤º dp[u][0], max2 è¡¨ç¤º dp[u][1]ã€‚

```cpp
class Solution {
public:
    int treeDiameter(vector<vector<int>>& edges) {
        int n = edges.size();
        vector<vector<int> > g(n + 1);
        for(const auto &e: edges)
        {
            g[e[0]].push_back(e[1]);
            g[e[1]].push_back(e[0]);
        }
        int ans = 0;
        dfs(0, -1, g, ans);
        return ans;
    }

private:
    int dfs(int u, int fa, const vector<vector<int> >& g, int& ans)
    {
        int max1 = 0, max2 = 0;
        for(int v: g[u])
        {
            if(v != fa)
            {
                int t = dfs(v, u, g, ans) + 1;
                if(max1 < t)
                {
                    max2 = max1;
                    max1 = t;
                }
                else if(max2 < t)
                    max2 = t;
            }
        }
        ans = max(ans, (max1 + max2));
        return max1;
    }
};

```

![Alt text](image-78.png)
![Alt text](image-79.png)
![Alt text](image-80.png)
```cpp
class Solution {
public:
    vector<int> findMinHeightTrees(int n, vector<vector<int>>& edges) {
        vector<vector<int> > g(n); // é‚»æ¥è¡¨
        for(vector<int> &edge: edges)
        {
            g[edge[0]].push_back(edge[1]);
            g[edge[1]].push_back(edge[0]);
        }
        vector<int> dpdown(n, 0), dpup(n, 0);
        // ç¬¬ä¸€æ¬¡DFSè®°å½•æ¯ä¸ªç»“ç‚¹åœ¨ä½œä¸ºå­æ ‘æ ¹ç»“ç‚¹çš„æœ€å¤§é«˜åº¦ã€‚
        dfs_1(0, -1, dpdown, g);
        // ç¬¬äºŒæ¬¡DFSè¡¥å…¨æ¯ä¸ªç»“ç‚¹ä½œä¸ºæ€»æ ¹ç»“ç‚¹çš„æœ€å¤§é«˜åº¦ï¼Œå·®è·å°±åœ¨äºéœ€è¦ç»Ÿè®¡ä¸Šä»çˆ¶ç»“ç‚¹ä¼ é€’è¿‡æ¥çš„å­æ ‘åˆ†æ”¯ã€‚
        dfs_2(0, -1, dpdown, dpup, g);

        int min_ans = n;
        vector<int> ans;
        for(int i = 0; i < n; ++i)
        {
            if(min_ans > dpdown[i])
            {
                min_ans = dpdown[i];
                ans.clear();
                ans.push_back(i);
            }
            else if(min_ans == dpdown[i])
                ans.push_back(i);
        }
        return ans;
    }

private:
    void dfs_1(int u, int fa, vector<int>& dpdown, vector<vector<int> >& g)
    {
        dpdown[u] = 0;
        for(auto &v: g[u])
        {
            if(v == fa) continue;
            dfs_1(v, u, dpdown, g);
            dpdown[u] = max(dpdown[u], dpdown[v] + 1);
        }
    }

    void dfs_2(int u, int fa, vector<int>& dpdown, vector<int>& dpup, vector<vector<int> >& g)
    {
        dpdown[u] = max(dpdown[u], dpup[u]);
        int max_1 = 0, max_2 = 0; // è¿™é‡Œéœ€è¦æœ€å¤§é«˜åº¦å’Œæ¬¡å¤§é«˜åº¦
        for(auto &v: g[u])
        {
            if(v == fa) continue;
            if(max_1 < dpdown[v] + 1)
            {
                max_2 = max_1;
                max_1 = dpdown[v] + 1;
            }
            else if(max_2 < dpdown[v] + 1)
                max_2 = dpdown[v] + 1;
        }
        for(auto &v: g[u])
        {
            if(v == fa) continue;
            if (max_1 == dpdown[v] + 1) {
                // u åœ¨ fa çš„æœ€é•¿é“¾ä¸Š
                dpup[v] = max(dpup[u], max_2) + 1;
                dfs_2(v, u, dpdown, dpup, g);
            }
            else {
                dpup[v] = max(dpup[u], max_1) + 1;
                dfs_2(v, u, dpdown, dpup, g);
            }
        }
    }
};



```

![alt text](image-81.png)
834. æ ‘ä¸­è·ç¦»ä¹‹å’Œ
1569. å°†å­æ•°ç»„é‡æ–°æ’åºå¾—åˆ°åŒä¸€ä¸ªäºŒå‰æŸ¥æ‰¾æ ‘çš„æ–¹æ¡ˆæ•°
124. äºŒå‰æ ‘ä¸­çš„æœ€å¤§è·¯å¾„å’Œ
543. äºŒå‰æ ‘çš„ç›´å¾„
333. æœ€å¤§ BST å­æ ‘
337. æ‰“å®¶åŠ«èˆ III
1373. äºŒå‰æœç´¢å­æ ‘çš„æœ€å¤§é”®å€¼å’Œ
1372. äºŒå‰æ ‘ä¸­çš„æœ€é•¿äº¤é”™è·¯å¾„
968. ç›‘æ§äºŒå‰æ ‘
1273. åˆ é™¤æ ‘èŠ‚ç‚¹
1519. å­æ ‘ä¸­æ ‡ç­¾ç›¸åŒçš„èŠ‚ç‚¹æ•°
1617. ç»Ÿè®¡å­æ ‘ä¸­åŸå¸‚ä¹‹é—´æœ€å¤§è·ç¦»


## å›¾ä¸ŠåŠ¨æ€è§„åˆ’
ã€Œå›¾ä¸Š DPã€å°±æ˜¯åœ¨å›¾ç»“æ„ä¸Šçš„åŠ¨æ€è§„åˆ’é—®é¢˜ã€‚ä¸€èˆ¬å›¾èŠ‚ç‚¹æœ¬èº«ä¸ä½œä¸ºé˜¶æ®µï¼Œè€Œæ˜¯ä½œä¸ºé˜¶æ®µæŒæœ‰çš„çŠ¶æ€ã€‚å¯¹äºæœ‰å‘å›¾ï¼Œå¦‚æœæ˜¯æ— ç¯çš„ï¼Œé‚£ä¹ˆå°±å¯ä»¥å°†èŠ‚ç‚¹æœ¬èº«ä½œä¸ºé˜¶æ®µï¼Œæ­¤æ—¶ä¸€èˆ¬ç”¨æ‹“æ‰‘åºè¿›è¡Œæ¨å¯¼ã€‚

![alt text](image-82.png)

![alt text](image-83.png)
```cpp
class Solution {
public:
    vector<int> mostSimilar(int n, vector<vector<int>>& roads, vector<string>& names, vector<string>& targetPath) {
        vector<vector<int>> g(n);
        for(vector<int> &e: roads)
        {
            g[e[0]].push_back(e[1]);
            g[e[1]].push_back(e[0]);
        }
        int m = targetPath.size();
        vector<vector<int>> ed(n, vector<int>(m, -1));
        for(int v = 0; v < n; ++v)
        {
            for(int i = 0; i < m; ++i)
                ed[v][i] = names[v] != targetPath[i];
        }
        vector<vector<int>> dp(n, vector<int>(m + 1, INT_MAX / 2));
        for(int v = 0; v < n; ++v)
            dp[v][0] = ed[v][0];
        for(int i = 1; i < m; ++i)
            for(int v = 0; v < n; ++v)
            {
                for(int u: g[v])
                    dp[v][i] = min(dp[v][i], ed[v][i] + dp[u][i - 1]);
            }
        int end = -1;
        int min_ed = INT_MAX / 2;
        for(int v = 0; v < n; ++v)
        {
            if(dp[v][m - 1] < min_ed)
            {
                end = v;
                min_ed = dp[v][m - 1];
            }
        }
        vector<int> result(m);
        result[m - 1] = end;
        int next = end;
        for(int i = m - 2; i >= 0; --i)
        {
            int u = -1;
            for(int v: g[next])
                if(dp[v][i] == dp[next][i + 1] - ed[next][i + 1])
                {
                    u = v;
                    break;
                }
            result[i] = u;
            next = u;
        }
        return result;
    }
};


```
![alt text](image-84.png)

![alt text](image-85.png)
```cpp
class Solution {
public:
    int maxVacationDays(vector<vector<int>>& flights, vector<vector<int>>& days) {
        int N = days.size();
        int K = days[0].size();
        // days : N * K
        vector<vector<int>> dp(N, vector<int>(K, 0));
        vector<vector<int>> &adj = flights;
        for(int i = 0; i < N; ++i)
            dp[i][K - 1] = days[i][K - 1];
        for(int k = K - 2; k >= 0; --k)
            for(int i = 0; i < N; ++i)
            {
                dp[i][k] = dp[i][k + 1]; // ä¸åèˆªç­
                for(int j = 0; j < N; ++j)
                {
                    if(adj[i][j] == 1)
                        dp[i][k] =  max(dp[i][k], dp[j][k + 1]);
                }
                dp[i][k] += days[i][k];
            }
        int ans = dp[0][0];
        for(int start = 1; start < N; ++start)
        {
            if(adj[0][start] == 1)
                ans = max(ans, dp[start][0]);
        }
        return ans;
    }
};


```
![alt text](image-86.png)

![alt text](image-87.png)
```cpp
class Solution {
public:
    int maxJumps(vector<int>& arr, int d) {
        if(arr.empty()) return 0;
        int n = arr.size();
        dp = vector<int>(n, -1);
        int ans = 1;
        for(int i = 0; i < n; ++i)
            if(dp[i] == -1)
                ans = max(ans, solve(arr, d, i));
        return ans;
    }

private:
    // dp[i] := ä»¥ i å¼€å¤´çš„æœ€é•¿è·¯å¾„
    vector<int> dp;

    int solve(const vector<int>& arr, const int d, int pos)
    {
        if(dp[pos] != -1)
            return dp[pos];
        dp[pos] = 0;
        int n = arr.size();
        for(int k = 1; k <= d; ++k)
        {
            int nxt = pos + k;
            if(nxt >= n || arr[pos] <= arr[nxt])
                break;
            dp[pos] = max(dp[pos], 1 + solve(arr, d, nxt));
        }
        for(int k = 1; k <= d; ++k)
        {
            int nxt = pos - k;
            if(nxt < 0 || arr[pos] <= arr[nxt])
                break;
            dp[pos] = max(dp[pos], 1 + solve(arr, d, nxt));
        }
        dp[pos] = max(1, dp[pos]);
        return dp[pos];
    }
};



```


![alt text](image-88.png)

## æ¦‚ç‡åŠ¨æ€è§„åˆ’
ã€Œæ¦‚ç‡ DPã€ã€ã€ŒæœŸæœ› DPã€ æ˜¯ä¸€ç§åº”ç”¨åŠ¨æ€è§„åˆ’è§£å†³æ±‚æ¦‚ç‡ã€æœŸæœ›é—®é¢˜çš„ä¸€ç±»æ–¹æ³•ã€‚
æœ¬ç« åˆ†ä¸ºã€Œæ¦‚ç‡ DPã€ å’Œ ã€ŒæœŸæœ› DPã€ ä¸¤éƒ¨åˆ†ã€‚é¦–å…ˆç»™å‡ºå…¶ç†è®ºåŸºç¡€ä»¥åŠå¯¹åº”çš„ DP è½¬ç§»æ–¹ç¨‹çš„å½¢å¼ï¼›ç„¶åé€šè¿‡æ‹†è§£ä¸¤é“ä¾‹é¢˜å¸®åŠ©å„ä½åŠ æ·±ç†è§£ï¼›æœ€ååˆ—å‡ºåŒç±»å‹é¢˜ç›®æ¸…å•ï¼Œå¸®åŠ©å¤§å®¶å·©å›ºå­¦ä¹ ã€‚

![alt text](image-89.png)
![alt text](image-90.png)

![alt text](image-91.png)
```
çŠ¶æ€å®šä¹‰
dp[i][j] := ç¬¬ j è½® i è·èƒœ

ç­”æ¡ˆ
max(dp[n - 1][i])

åˆå§‹åŒ–
dp[i][0] = p[i][k], if check(i, 0, k)

çŠ¶æ€è½¬ç§»
dp[i][j] = sum(dp[i][j - 1] * dp[k]dp[j - 1] * p[i][k])


```

```cpp
#include <cmath>
#include <iostream>
#include <vector>

using namespace std;

bool check(int i, int j, int k)
{
    // åˆ¤æ–­ i, k æ˜¯å¦å¯èƒ½åœ¨ç¬¬ j è½®æˆä¸ºå¯¹æ‰‹
    i >>= j;
    k >>= j;
    return i ^ k == 1;
}

int main()
{
    int n;
    cin >> n;
    int N = pow(2, n);
    vector<vector<double>> P(N, vector<double>(N, -1.0));
    for(int i = 0; i < N; ++i)
        for(int j = 0; j < N; ++j)
            cin >> P[i][j];
    vector<vector<double>> dp(N, vector<double>(n, -1.0));
    for(int i = 0; i < N; ++i)
    {
        if(i & 1)
            dp[i][0] = P[i][i - 1];
        else
            dp[i][0] = P[i][i + 1];
    }
    for(int j = 1; j < n; ++j)
    {
        for(int i = 0; i < N; ++i)
            for(int k = 0; k < N; ++k)
                if(check(i, j, k))
                    dp[i][j] += dp[i][j - 1] * dp[k][j - 1] * P[i][k];
    }
    double max_p = -1.0;
    int ans = -1;
    for(int i = 0; i < n; ++i)
        if(dp[i][n - 1] > max_p)
        {
            max_p = dp[i][n - 1];
            ans = i;
        }
    cout << ans + 1 << endl;
}


```
![alt text](image-92.png)
![alt text](image-93.png)
```cpp
#include <vector>
#include <iostream>
#include <iomanip>

using namespace std;

int main()
{
    int M, T, N;
    cin >> M >> T >> N;
    vector<vector<double>> P(T, vector<double>(M, -1.0));
    for(int i = 0; i < T; ++i)
        for(int j = 0; j < M; ++j)
            cin >> P[i][j];
    vector<vector<double>> dp(M, vector<double>(M + 1, -1.0));
    double pa = 1.0;
    double pb_a = 1.0;
    for(int t = 0; t < T; ++t)
    {
        dp.assign(N, vector<double>(M + 1, -1.0));
        dp[0][0] = (1 - P[t][0]);
        dp[0][1] = P[t][0];
        for(int i = 1; i < M; ++i)
        {
            dp[i][0] = (1 - P[t][0]) * dp[i - 1][0];
            for(int j = 1; j <= i; ++j)
                dp[i][j] = P[t][i] * dp[i - 1][j - 1] + (1 - P[t][i]) * dp[i - 1][j];
        }
        pa *= 1 - dp[M - 1][0];
        double tmp = 0.0;
        for(int j = 1; j < N; ++j)
            tmp += dp[M - 1][j];
        pb_a *= tmp / (1 - dp[M - 1][0]);
    }
    pb_a = 1 - pb_a;
    double ans = pa * pb_a;
    cout << std::fixed << std::setprecision(4);
    cout << ans << endl;
}


```
æœ¬èŠ‚ä¸ºå¤§å®¶æ±‡æ€»äº†åŠ›æ‰£ä¸Š 8 é“ã€Œæ¦‚ç‡ DPã€çš„é¢˜ç›®ï¼Œå¤§å®¶å¯ä»¥é›†ä¸­ç»ƒä¹ ã€‚

808. åˆ†æ±¤
837. æ–°21ç‚¹
1230. æŠ›æ·ç¡¬å¸
688. â€œé©¬â€åœ¨æ£‹ç›˜ä¸Šçš„æ¦‚ç‡
1467. ä¸¤ä¸ªç›’å­ä¸­çƒçš„é¢œè‰²æ•°ç›¸åŒçš„æ¦‚ç‡
å‰‘æŒ‡ Offer 60. nä¸ªéª°å­çš„ç‚¹æ•°
1227. é£æœºåº§ä½åˆ†é…æ¦‚ç‡
1377. T ç§’åé’è›™çš„ä½ç½®

![alt text](image-94.png)

![alt text](image-95.png)
```cpp
#include <vector>
#include <fstream>
#include <iostream>

using namespace std;

double solve(int i, const int n, const int m, vector<double>& dp)
{
    if(dp[i] > -0.5)
        return dp[i];
    if(i == m)
        return dp[i] = 0.0;

    return dp[i] = (n + (n - i) * solve(i + 1, n, m, dp)) / (n - i);
}

int main()
{
    ifstream fin("data.txt");
    vector<double> dp;
    int n, m;
    while((fin >> n) && (fin >> m))
    {
        cout << "n: " << n << ", m: " << m << endl;
        dp.assign(m + 1, -1.0);
        double ans = solve(0, n, m, dp);
        cout << ans << endl;
    }
}


```
æ¨¡æ‹Ÿä»£ç 

```cpp
import numpy as np
from multiprocessing import Pool

class Simulater:
    def __init__(self, n, m):
        self.n = n
        self.m = m

    def test(self, T):
        np.random.seed()
        N = 0
        for _ in range(T):
            i = 0
            j = 0
            visited = [False] * self.n
            while j < self.m:
                i += 1
                x = np.random.randint(0, self.n)
                if not visited[x]:
                    visited[x] = True
                    j += 1
            N += i
        return N / T

with open("data.txt") as f:
    for line in f.readlines():
        line = line.strip().split(" ")
        n = int(line[0])
        m = int(line[1])
        s = Simulater(n, m)
        T = int(5e5)
        pool = Pool(8)
        ts = pool.map(s.test, [T] * 8)
        print(sum(ts) / 8)

```

![alt text](image-96.png)
![alt text](image-97.png)
```cpp
#include <vector>
#include <fstream>
#include <iostream>

using namespace std;

double solve(int i, int j, const int n, const int m, vector<vector<double>>& dp)
{
    if(dp[i][j] > -0.5)
        return dp[i][j];
    if(i == m)
        return dp[i][j] = 0.0;

    double ans = 0.0;
    ans += j / (double)n * solve(i + 1, j, n, m, dp);
    ans += (n - j) / (double)n * (1 + solve(i + 1, j + 1, n, m, dp));
    return dp[i][j] = ans;
}

int main()
{
    ifstream fin("data.txt");
    vector<vector<double>> dp;
    int n, m;
    while((fin >> n) && (fin >> m))
    {
        cout << "n: " << n << ", m: " << m << endl;
        dp.assign(m + 1, vector<double>(m + 1, -1.0));
        double ans = solve(0, 0, n, m, dp);
        cout << ans << endl;
    }
}


```
æ€è·¯2
```cpp
#include <vector>
#include <fstream>
#include <iostream>

using namespace std;

double solve(int i, const int n, const int m, vector<double>& dp)
{
    if(dp[i] > -0.5)
        return dp[i];
    if(i == 0)
        return dp[i] = 0.0;
    return dp[i] = 1 + (n - 1) / (double)n * solve(i - 1, n, m, dp);
}

int main()
{
    ifstream fin("data.txt");
    vector<double> dp;
    int n, m;
    while((fin >> n) && (fin >> m))
    {
        cout << "n: " << n << ", m: " << m << endl;
        dp.assign(m + 1, -1.0);
        double ans = solve(m, n, m, dp);
        cout << ans << endl;
    }
}


```
![alt text](image-98.png)

## åšå¼ˆåŠ¨æ€è§„åˆ’
åšå¼ˆåŠ¨æ€è§„åˆ’
ã€Œåšå¼ˆ DPã€ï¼Œä¸€ç§åº”ç”¨åŠ¨æ€è§„åˆ’è§£å†³åšå¼ˆé—®é¢˜çš„ç®—æ³•ã€‚æœ¬ç« é¦–å…ˆç»™å‡ºç†è®ºåŸºç¡€ï¼ˆminimaxï¼‰ä»¥åŠå¯¹åº”çš„ DP è½¬ç§»æ–¹ç¨‹å½¢å¼ï¼›ç„¶åé€šè¿‡è¯¦ç»†æ‹†è§£ Leetcode ä¸Š 4 é“é¢˜æ¥å­¦ä¹ è¿™ç±»é—®é¢˜çš„è§£å†³æ€è·¯ã€‚ã€Œåšå¼ˆ DPã€åœ¨ Leetocde ä¸Šæœ‰ä¸å°‘é¢˜ç›®ï¼Œç« èŠ‚æœ«å°¾å°†é›†ä¸­åˆ—å‡ºæ¥ï¼Œå¤§å®¶å¯ä»¥è¿›è¡Œé’ˆå¯¹æ€§ç»ƒä¹ ã€‚

![alt text](image-99.png)
![alt text](image-100.png)
![alt text](Snipaste_2025-09-14_14-27-11.png)
```cpp
class Solution {
public:
    bool stoneGame(vector<int>& piles) {
        int n = piles.size();
        vector<vector<int>> dp(n, vector<int>(n));
        int all = 0;
        for(int i = 0; i < n; ++i)
        {
            all += piles[i];
            dp[i][i] = piles[i];
        }
        for(int i = 0; i < n - 1; ++i)
            dp[i][i + 1] = max(piles[i], piles[i + 1]);
        for(int l = 3; l <= n; ++l)
        {
            // l ä¸ºåŒºé—´é•¿åº¦
            for(int i = 0; i + l <= n; ++i)
            {
                int j = i + l - 1;
                dp[i][j] = max(piles[i] + min(dp[i + 2][j], dp[i + 1][j - 1])
                              ,piles[j] + min(dp[i + 1][j - 1], dp[i][j - 2])
                              );
            }
        }
        return dp[0][n - 1] * 2 > all;
    }
};


```
![alt text](image-101.png)
```cpp
class Solution {
public:
    bool nimGame(vector<int>& piles) {
        int n = piles.size();
        vector<int> dp(1 << (n * 3), -1);
        dp[0] = 0;
        int t = 0;
        for(int i = 0; i < n; ++i)
            t += (piles[i] << (3 * i));
        return solve(t, n, dp) == 1;
    }

private:
    int solve(int s, const int n, vector<int>& dp)
    {
        if(dp[s] != -1)
            return dp[s];
        for(int i = 0; i < n; ++i)
        {
            int m = ((s >> (i * 3)) & 7);
            for(int j = 0; j < m; ++j)
            {
                int t = s & (~(7 << (i * 3)));
                t += j << (i * 3);
                if(solve(t, n, dp) == 0)
                    return dp[s] = 1;
            }
        }
        return dp[s] = 0;
    }
};


```
![alt text](image-102.png)
```cpp
class Solution {
public:
    int getMoneyAmount(int n) {
        vector<vector<int> > dp(n + 1, vector<int>(n + 1, INT_MAX));
        for(int i = 1; i <= n; ++i)
            dp[i][i] = 0;
        for(int j = 2; j <= n; ++j)
            for(int i = j - 1; i >= 1; --i)
            {
                dp[i][j] = min(dp[i + 1][j] + i, dp[i][j - 1] + j);
                for(int k = i + 1; k <= j - 1; ++k)
                    dp[i][j] = min(dp[i][j], max(dp[k + 1][j], dp[i][k - 1]) + k);
            }
        return dp[1][n];
    }
};


```

![alt text](image-103.png)
```cpp
class Solution {
public:
    bool canWin(string s) {
        int n = s.size();
        if(n < 2) return false;
        unordered_map<string, bool> dp;
        return solve(s, dp);
    }

private:
    bool solve(string& s, unordered_map<string, bool>& dp)
    {
        int n = s.size();
        if(dp.find(s) != dp.end()) // è¯¥çŠ¶æ€å·²ç»ç®—è¿‡
            return dp[s];
        for(int i = 0; i < n - 1; ++i) // æšä¸¾æ‰€æœ‰æ¬¡æ€
        {
            if(s[i] == '+' && s[i + 1] == '+')
            {
                s[i] = '-';
                s[i + 1] = '-';
                bool f = solve(s, dp);
                s[i] = '+';
                s[i + 1] = '+';
                if(!f)
                    return dp[s] = true;
            }
        }
        return dp[s] = false;
    }
};


```

æœ¬å°èŠ‚ä¸ºå¤§å®¶æ±‡æ€»äº†åŠ›æ‰£ä¸Š 12 é“å…³äºã€Œåšå¼ˆ DPã€çš„é¢˜ç›®ï¼Œå¤§å®¶å¯ä»¥é›†ä¸­ç»ƒä¹ ã€‚

ç¿»è½¬æ¸¸æˆ
293. ç¿»è½¬æ¸¸æˆ
Nim æ¸¸æˆ
292. Nim æ¸¸æˆ
çŸ³å­æ¸¸æˆ
1140. çŸ³å­æ¸¸æˆ II
1406. çŸ³å­æ¸¸æˆ III
1510. çŸ³å­æ¸¸æˆ IV
äº•å­—æ¸¸æˆ
348. åˆ¤å®šäº•å­—æ£‹èƒœè´Ÿ
794. æœ‰æ•ˆçš„äº•å­—æ¸¸æˆ
1275. æ‰¾å‡ºäº•å­—æ£‹çš„è·èƒœè€…
å…¶å®ƒ
486. é¢„æµ‹èµ¢å®¶
464. æˆ‘èƒ½èµ¢å—
1025. é™¤æ•°åšå¼ˆ
913. çŒ«å’Œè€é¼ 

# æ»‘åŠ¨çª—å£å’ŒåŒæŒ‡é’ˆ

æ»‘åŠ¨çª—å£å’ŒåŒæŒ‡é’ˆæ˜¯è§£å†³å­—ç¬¦ä¸²ã€æ•°ç»„ç­‰é—®é¢˜çš„å¸¸ç”¨æŠ€å·§ã€‚é€šè¿‡ç»´æŠ¤ä¸€ä¸ªçª—å£æˆ–ä¸¤ä¸ªæŒ‡é’ˆï¼Œå¯ä»¥æœ‰æ•ˆåœ°éå†æ•°æ®ç»“æ„ï¼Œè¾¾åˆ°ä¼˜åŒ–æ—¶é—´å¤æ‚åº¦çš„ç›®çš„ã€‚

æ»‘åŠ¨çª—å£é€šå¸¸ç”¨äºå¤„ç†è¿ç»­å­æ•°ç»„æˆ–å­å­—ç¬¦ä¸²çš„é—®é¢˜ã€‚é€šè¿‡åŠ¨æ€è°ƒæ•´çª—å£çš„å·¦å³è¾¹ç•Œï¼Œå¯ä»¥åœ¨ O(n) çš„æ—¶é—´å¤æ‚åº¦å†…æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„å­æ•°ç»„æˆ–å­å­—ç¬¦ä¸²ã€‚
åŒæŒ‡é’ˆåˆ™å¸¸ç”¨äºæ’åºæ•°ç»„æˆ–é“¾è¡¨çš„é—®é¢˜ã€‚é€šè¿‡ä¸¤ä¸ªæŒ‡é’ˆåŒæ—¶éå†æ•°æ®ç»“æ„ï¼Œå¯ä»¥æœ‰æ•ˆåœ°è§£å†³æŸ¥æ‰¾ã€åˆå¹¶ç­‰é—®é¢˜ã€‚

## å¾ªç¯ä¸å˜é‡
å¾ªç¯å‰ã€ä¸­ã€åä¿æŒä¸å˜
ã€Œå¾ªç¯ä¸å˜é‡ã€ä¸æ˜¯å¾ˆé«˜æ·±çš„æ¦‚å¿µï¼Œåœ¨ã€Œç®—æ³•ã€å’Œã€Œæ•°æ®ç»“æ„ã€çš„ä¸–ç•Œé‡Œï¼Œåˆ°å¤„éƒ½æœ‰å®ƒçš„èº«å½±ã€‚

ã€Œå¾ªç¯ä¸å˜é‡ã€æ˜¯æŒ‡æˆ‘ä»¬åœ¨ç¼–å†™ä»£ç çš„è¿‡ç¨‹ä¸­ï¼Œè¦ä¸€ç›´å¾ªåºä¸å˜çš„æ€§è´¨ï¼Œè¿™æ ·çš„æ€§è´¨æ˜¯æ ¹æ®è¦è§£å†³çš„é—®é¢˜ï¼Œç”±æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ã€‚ã€Œå¾ªç¯ä¸å˜é‡ã€æ˜¯æˆ‘ä»¬å†™å¯¹ä¸€ä¸ªé—®é¢˜çš„åŸºç¡€ï¼Œä¿è¯äº†åœ¨ã€Œåˆå§‹åŒ–ã€ã€Œå¾ªç¯éå†ã€ã€Œç»“æŸã€è¿™ä¸‰ä¸ªé˜¶æ®µç›¸åŒçš„æ€§è´¨ï¼Œä½¿å¾—ä¸€ä¸ªé—®é¢˜èƒ½å¤Ÿè¢«æ­£ç¡®è§£å†³ã€‚

![alt text](image-104.png)
![alt text](image-105.png)
![alt text](Snipaste_2025-09-14_14-33-19.png)

![alt text](Snipaste_2025-09-14_14-33-34.png)
![alt text](image-106.png)
![alt text](Snipaste_2025-09-14_14-33-50.png)

## ä½¿ç”¨å¾ªç¯ä¸å˜é‡å†™å¯¹ä»£ç 
è¿™ä¸€èŠ‚æˆ‘ä»¬è®²è§£ä¸¤ä¸ªéå¸¸åŸºç¡€ä¸”å¸¸è€ƒçš„é—®é¢˜ï¼Œå‘å¤§å®¶å±•ç¤ºï¼šæˆ‘ä»¬åœ¨å†™ä»£ç çš„æ—¶å€™ä¸€å®šè¦æ˜ç¡®è‡ªå·±å¯¹å˜é‡ä»¥åŠåŒºé—´çš„å®šä¹‰æ˜¯ä»€ä¹ˆï¼Œå¹¶ä¸”åœ¨ç¼–å†™ä»£ç çš„è¿‡ç¨‹ä¸­ä¿æŒå®šä¹‰ä¸å˜ã€‚

![alt text](image-107.png)
![alt text](image-108.png)
```java
import java.util.Arrays;


public class Solution {

    public void sortColors(int[] nums) {
        int len = nums.length;
        if (len < 2) {
            return;
        }
        
        int zero = 0;
        int two = len;
        int i = 0;
        while (i < two) {
            if (nums[i] == 0) {
                swap(nums, i, zero);
                zero++;
                i++;
            } else if (nums[i] == 1) {
                i++;
            } else {
                two--;
                swap(nums, i, two);
            }
        }
    }

    private void swap(int[] nums, int index1, int index2) {
        int temp = nums[index1];
        nums[index1] = nums[index2];
        nums[index2] = temp;
    }
}


```
![alt text](image-109.png)
```java
public class Solution {

    public void sortColors(int[] nums) {
        int len = nums.length;
        if (len < 2) {
            return;
        }
        int zero = -1;
        int two = len - 1;
        int i = 0;
        while (i <= two) {
            if (nums[i] == 0) {
                zero++;
                swap(nums, i, zero);
                i++;
            } else if (nums[i] == 1) {
                i++;
            } else {
                swap(nums, i, two);
                two--;
            }
        }
    }

    private void swap(int[] nums, int index1, int index2) {
        int temp = nums[index1];
        nums[index1] = nums[index2];
        nums[index2] = temp;
    }
}


```
![alt text](Snipaste_2025-09-14_14-37-18.png)

![alt text](image-110.png)

```java
import java.util.Arrays;
import java.util.Random;

public class Solution {

    private static Random random = new Random(System.currentTimeMillis());

    public int findKthLargest(int[] nums, int k) {
        int len = nums.length;
				// ç¬¬ k å¤§å…ƒç´ çš„ä¸‹æ ‡æ˜¯ len - k
        int target = len - k;

        int left = 0;
        int right = len - 1;
        while (true) {
            int pIndex = partition(nums, left, right);

            if (pIndex == target) {
                return nums[pIndex];
            } else if (pIndex < target) {
                // ä¸‹ä¸€è½®æœç´¢åŒºé—´ [pIndex + 1..right]
                left = pIndex + 1;
            } else {
                // pIndex > target
                // ä¸‹ä¸€è½®æœç´¢åŒºé—´ [left..pIndex - 1]
                right = pIndex - 1;
            }
        }

    }

    private int partition(int[] nums, int left, int right) {
        // æ³¨æ„ï¼šå¿…é¡»éšæœºåŒ–
        int randomIndex = left + random.nextInt(right - left + 1);
        swap(nums, left, randomIndex);

        int pivot = nums[left];
        // [left + 1 .. le] <= pivot
        // (le..i] > pivot
        // æ³¨æ„ï¼šä¸€å®šè¦è®¾ç½®æˆ left ï¼Œå¦åˆ™äº¤æ¢ä¼šå‡ºé”™
        int le = left;
        for (int i = left + 1; i <= right; i++) {
            // è¿™é‡Œå†™ < æˆ–è€… <= éƒ½å¯ä»¥
            if (nums[i] <= pivot) {
                le++;
                swap(nums, le, i);
            }
        }

        swap(nums, left, le);
        return le;
    }

    private void swap(int[] nums, int index1, int index2) {
        int temp = nums[index1];
        nums[index1] = nums[index2];
        nums[index2] = temp;
    }
}


```
![alt text](image-111.png)
```java
import java.util.Random;

public class Solution {

    private static Random random = new Random(System.currentTimeMillis());

    public int findKthLargest(int[] nums, int k) {
        int len = nums.length;
        int left = 0;
        int right = len - 1;

        // ç¬¬ k å¤§å…ƒç´ çš„ä¸‹æ ‡æ˜¯ len - k
        int target = len - k;

        while (true) {
            int index = partition(nums, left, right);
            if (index == target) {
                return nums[index];
            } else if (index < target) {
                left = index + 1;
            } else {
                right = index - 1;
            }
        }
    }

    public int partition(int[] nums, int left, int right) {
        // åœ¨åŒºé—´éšæœºé€‰æ‹©ä¸€ä¸ªå…ƒç´ ä½œä¸ºæ ‡å®šç‚¹
        int randomIndex = left + random.nextInt(right - left + 1 );
        swap(nums, left, randomIndex);
        

        int pivot = nums[left];

        // å°†ç­‰äº pivot çš„å…ƒç´ åˆ†æ•£åˆ°ä¸¤è¾¹
        // [left..le) <= pivot
        // (ge..right] >= pivot

        int le = left + 1;
        int ge = right;

        while (true) {
            // é‡åˆ° nums[le] >= pivot çš„æ—¶å€™åœä¸‹æ¥
            // é‡åˆ°ä¸ pivot ç›¸ç­‰çš„å…ƒç´ ï¼Œæ˜¯é€šè¿‡äº¤æ¢è¢«ç­‰æ¦‚ç‡åˆ†åˆ°ä¸¤è¾¹çš„
            while (le <= ge && nums[le] < pivot) {
                le++;
            }
            while (le <= ge && nums[ge] > pivot) {
                ge--;
            }

            if (le > ge) {
                break;
            }
            swap(nums, le, ge);
            le++;
            ge--;
        }

        // è¿™é‡Œè¿˜è¦äº¤æ¢ï¼Œæ³¨æ„æ˜¯ ge
        swap(nums, left, ge);
        return ge;
    }

    private void swap(int[] nums, int index1, int index2) {
        int temp = nums[index1];
        nums[index1] = nums[index2];
        nums[index2] = temp;
    }
}


```
![alt text](image-112.png)

```java
import java.util.Random;

public class Solution {

    private static Random RANDOM = new Random(System.currentTimeMillis());

    public int findKthLargest(int[] nums, int k) {
        int len = nums.length;
        int target = len - k;

        int left = 0;
        int right = len - 1;
        while (true) {
            int[] pIndex = partition(nums, left, right);

            int index1 = pIndex[0];
            int index2 = pIndex[1];

            if (target < index1) {
                // ä¸‹ä¸€è½®æœç´¢åŒºé—´ [left..index1 - 1]
                right = index1 - 1;
            } else if (target == index1) {
                return nums[index1];
            } else if (target < index2) {
                left = index1 + 1;
                right = index2 - 1;
            } else if (target == index2) {
                return nums[index2];
            } else {
                // pIndex > target
                // ä¸‹ä¸€è½®æœç´¢åŒºé—´ [index2 + 1..right]
                left = index2 + 1;
            }
        }
    }

    private int[] partition(int[] nums, int left, int right) {
        int randomIndex = left + RANDOM.nextInt(right - left + 1);
        swap(nums, randomIndex, left);

        // å¾ªç¯ä¸å˜é‡ï¼š
        // all in [left + 1..lt] < pivot
        // all in [lt + 1..i) = pivot
        // all in [gt..right] > pivot
        int pivot = nums[left];
        int lt = left;
        int gt = right + 1;

        int i = left + 1;
        while (i < gt) {
            if (nums[i] < pivot) {
                lt++;
                swap(nums, i, lt);
                i++;
            } else if (nums[i] == pivot) {
                i++;
            } else {
                gt--;
                swap(nums, i, gt);
            }
        }
        swap(nums, left, lt);
        // è¿™é‡Œè¦ç‰¹åˆ«å°å¿ƒ
        return new int[]{lt, gt - 1};
    }

    private void swap(int[] nums, int index1, int index2) {
        int temp = nums[index1];
        nums[index1] = nums[index2];
        nums[index2] = temp;
    }
}


```

## æ»‘åŠ¨çª—å£ 1ï¼šåŒå‘äº¤æ›¿ç§»åŠ¨çš„ä¸¤ä¸ªå˜é‡
åŒå‘äº¤æ›¿ç§»åŠ¨çš„ä¸¤ä¸ªå˜é‡
æœ‰ä¸€ç±»æ•°ç»„ä¸Šçš„é—®é¢˜ï¼Œé—®æˆ‘ä»¬å›ºå®šé•¿åº¦çš„æ»‘åŠ¨çª—å£çš„æ€§è´¨ï¼Œè¿™ä¸€ç±»é—®é¢˜åœ¨æ€ç»´å±‚é¢ä¸Šç›¸å¯¹ç®€å•ã€‚æˆ‘ä»¬é€šè¿‡ä¸¤é“ç®€å•çš„ä¾‹é¢˜å‘å¤§å®¶å±•ç¤ºè¿™ä¸€ç±»é—®é¢˜çš„å†™æ³•ã€‚

![alt text](image-113.png)
```java
public class Solution {

    public double findMaxAverage(int[] nums, int k) {
        int len = nums.length;
        // ç”±äºé¢˜ç›®é™åˆ¶äº† k <= lenï¼Œå› æ­¤ä¸ç”¨åšç‰¹åˆ¤
        int windowSum = 0;
        // ç¬¬ 1 æ­¥ï¼šå…ˆæ±‚å‡ºç¬¬ 1 ä¸ªçª—å£çš„å’Œ
      	for (int i = 0; i < k; i++) {
            windowSum += nums[i];
        }

      	// ç¬¬ 2 æ­¥ï¼šé€šè¿‡éå†æ±‚å‡ºé™¤äº†ç¬¬ 1 ä¸ªçª—å£çš„å’Œ
        int res = windowSum;
        // å¾ªç¯ä¸å˜é‡å®šä¹‰ï¼š[left..right) æ˜¯é•¿åº¦ä¸º k çš„çª—å£
        for (int right = k; right < len; right++) {
            // åŠ ä¸Šä¸€ä¸ªæ•°å†å‡å»ä¸€ä¸ªæ•°
            windowSum = windowSum + nums[right] - nums[right - k];
            res = Math.max(res, windowSum);
        }
        return (double) res / k;
    }
}


```
![alt text](Snipaste_2025-09-14_14-40-57.png)

![alt text](Snipaste_2025-09-14_14-43-41.png)
![alt text](image-114.png)
```java
public class Solution {

    public int maxSatisfied(int[] customers, int[] grumpy, int X) {
        int len = grumpy.length;
        // å‰ç¼€å’Œ preSum[i] è¡¨ç¤º [0..i) é‡Œå› ä¸ºè€æ¿ç”Ÿæ°”è€Œæ„Ÿåˆ°ä¸å¼€å¿ƒçš„é¡¾å®¢æ•°
        int[] preSum = new int[len + 1];

        // ç»Ÿè®¡ 1. æ‰€æœ‰æœ¬æ¥å°±ä¸ç”Ÿæ°”çš„é¡¾å®¢æ•°é‡ï¼›2. å‰ç¼€å’Œæ•°ç»„
        int originCount = 0;
        for (int i = 0; i < len; i++) {
            if (grumpy[i] == 0) {
                // ä¸ç”Ÿæ°”
                originCount += customers[i];
                preSum[i + 1] = preSum[i];
            } else {
                // ç”Ÿæ°”æ—¶å€™å‰ç¼€å’Œ
                preSum[i + 1] = preSum[i] + customers[i];
            }
        }

        int maxAngryCount = 0;
        // å›ºå®šé•¿åº¦çš„æ»‘åŠ¨çª—å£çš„å·¦è¾¹ç•Œï¼š[i..i + X)
        for (int left = 0; left < len - X + 1; left++) {
            maxAngryCount = Math.max(maxAngryCount, preSum[left + X] - preSum[left]);
        }
        // æ‰€æœ‰æœ¬æ¥å°±ä¸ç”Ÿæ°”çš„é¡¾å®¢
        return originCount + maxAngryCount;
    }
}


```

![alt text](image-115.png)

## æ»‘åŠ¨çª—å£ 2ï¼šä¸å®šé•¿åº¦çš„æ»‘åŠ¨çª—å£
æœ‰ä¸€ç±»æ•°ç»„ä¸Šçš„é—®é¢˜ï¼Œéœ€è¦ä½¿ç”¨ä¸¤ä¸ªæŒ‡é’ˆå˜é‡ï¼ˆæˆ‘ä»¬ç§°ä¸ºå·¦æŒ‡é’ˆå’Œå³æŒ‡é’ˆï¼‰ï¼ŒåŒå‘ã€äº¤æ›¿å‘å³ç§»åŠ¨å®Œæˆä»»åŠ¡ã€‚è¿™æ ·çš„è¿‡ç¨‹åƒæäº†ä¸€ä¸ªçª—å£åœ¨å¹³é¢ä¸Šæ»‘åŠ¨çš„è¿‡ç¨‹ï¼Œå› æ­¤æˆ‘ä»¬å°†è§£å†³è¿™ä¸€ç±»é—®é¢˜çš„ç®—æ³•ç§°ä¸ºã€Œæ»‘åŠ¨çª—å£ã€é—®é¢˜ã€‚

æŒæ¡å¥½è¿™ä¸€ç±»ã€Œæ»‘åŠ¨çª—å£ã€çš„é—®é¢˜ï¼Œéœ€è¦å…ˆä»ã€Œæš´åŠ›è§£æ³•ã€å¼€å§‹åˆ†æï¼Œã€Œæ»‘åŠ¨çª—å£ã€åˆ©ç”¨äº†é—®é¢˜æœ¬èº«çš„ç‰¹ç‚¹ï¼Œåœ¨ä¸¤ä¸ªæŒ‡é’ˆåŒå‘ã€äº¤æ›¿å‘å³ç§»åŠ¨çš„è¿‡ç¨‹ä¸­ï¼Œå°‘è€ƒè™‘äº†å¾ˆå¤šã€Œæš´åŠ›è§£æ³•ã€éœ€è¦è€ƒå¯Ÿäº†æƒ…å†µï¼Œå°†æ—¶é—´å¤æ‚åº¦é™åˆ°äº†çº¿æ€§çº§åˆ« O(N)ï¼ˆè¿™é‡Œğ‘æ˜¯æ•°ç»„çš„é•¿åº¦ï¼‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚



![alt text](Snipaste_2025-09-14_14-45-34.png)

![alt text](image-116.png)
![alt text](image-117.png)

```java
public class Solution {

    public String minWindow(String s, String t) {
        int[] window = new int[128];
        int[] pattern = new int[128];

        final int A = 'A';

        for (Character c : t.toCharArray()) {
            pattern[c - A]++;
        }
        int distance = 0;

        for (int i = 0; i < 128; i++) {
            if (pattern[i] > 0) {
                distance++;
            }
        }

        int sLen = s.length();
        int start = 0;
        int left = 0;
        int right = 0;
        int match = 0;
        int minLen = sLen + 1;

        while (right < sLen) {
            Character curChar = s.charAt(right);
            if (pattern[curChar - A] > 0) {
                window[curChar - A]++;

                if (window[curChar - A] == pattern[curChar - A]) {
                    match++;
                }
            }

            right++;

            while (match == distance) {
                if (right - left < minLen) {
                    start = left;
                    minLen = right - left;
                }

                // è€ƒè™‘å·¦è¾¹ç•Œå‘å³è¾¹èµ°
                Character leftChar = s.charAt(left);
                if (pattern[leftChar - A] > 0) {
                    window[leftChar - A]--;

                    if (window[leftChar - A] < pattern[leftChar - A]) {
                        match--;
                    }
                }
                left++;
            }
        }
        return minLen == sLen + 1 ? "" : s.substring(start, start + minLen);
    }
}


```
![alt text](image-118.png)
![alt text](image-119.png)
![alt text](Snipaste_2025-09-14_14-47-38.png)

![alt text](Snipaste_2025-09-14_14-47-45.png)
```java
public class Solution {

    public int characterReplacement(String s, int k) {
        int len = s.length();
        if (len < 2) {
            return len;
        }

        char[] charArray = s.toCharArray();
        int left = 0;
        int right = 0;

        int res = 0;
        int maxCount = 0;
        int[] freq = new int[26];
        // [left, right) å†…æœ€å¤šæ›¿æ¢ k ä¸ªå­—ç¬¦å¯ä»¥å¾—åˆ°åªæœ‰ä¸€ç§å­—ç¬¦çš„å­ä¸²
        while (right < len){
            freq[charArray[right] - 'A']++;
            // åœ¨è¿™é‡Œç»´æŠ¤ maxCountï¼Œå› ä¸ºæ¯ä¸€æ¬¡å³è¾¹ç•Œè¯»å…¥ä¸€ä¸ªå­—ç¬¦ï¼Œå­—ç¬¦é¢‘æ•°å¢åŠ ï¼Œæ‰ä¼šä½¿å¾— maxCount å¢åŠ 
            maxCount = Math.max(maxCount, freq[charArray[right] - 'A']);
            right++;

            if (right - left > maxCount + k){
              	// è¯´æ˜æ­¤æ—¶ k ä¸å¤Ÿç”¨
                // æŠŠå…¶å®ƒä¸æ˜¯æœ€å¤šå‡ºç°çš„å­—ç¬¦æ›¿æ¢ä»¥åï¼Œéƒ½ä¸èƒ½å¡«æ»¡è¿™ä¸ªæ»‘åŠ¨çš„çª—å£ï¼Œè¿™ä¸ªæ—¶å€™é¡»è¦è€ƒè™‘å·¦è¾¹ç•Œå‘å³ç§»åŠ¨
                // ç§»å‡ºæ»‘åŠ¨çª—å£çš„æ—¶å€™ï¼Œé¢‘æ•°æ•°ç»„é¡»è¦ç›¸åº”åœ°åšå‡æ³•
                freq[charArray[left] - 'A']--;
                left++;
            }
            res = Math.max(res, right - left);
        }
        return res;
    }
}


```

![alt text](image-120.png)
![alt text](image-121.png)

![alt text](image-122.png)

## æ»‘åŠ¨çª—å£ 3ï¼šè®¡æ•°é—®é¢˜é€‰è®²
è¿™ä¸€èŠ‚æˆ‘ä»¬å‘å¤§å®¶ä»‹ç»å‡ ä¸ªå…³äºã€Œæ»‘åŠ¨çª—å£ã€çš„è®¡æ•°é—®é¢˜ï¼Œå†™å¯¹è®¡æ•°é—®é¢˜çš„æ ‡å‡†æ˜¯ï¼šä¸é‡ä¸æ¼ã€‚


![Alt text](image-123.png)

```java
public class Solution {

    public int lengthOfLongestSubstringTwoDistinct(String s) {
        int len = s.length();
        if (len < 3) {
            return len;
        }

        char[] charArray = s.toCharArray();
        int[] freq = new int[128];
        // æ»‘åŠ¨çª—å£é‡Œä¸åŒå­—ç¬¦çš„ä¸ªæ•°
        int count = 0;

        int res = 2;
        int left = 0;
        int right = 0;
        while (right < len) {
            freq[charArray[right]]++;
            if (freq[charArray[right]] == 1) {
                count++;
            }
            right++;

            while (count == 3) {
                freq[charArray[left]]--;
                if (freq[charArray[left]] == 0) {
                    count--;
                }
                left++;
            }
            // é€€å‡ºå¾ªç¯ä»¥åæœ‰ count = 2ï¼Œå› æ­¤åœ¨è¿™é‡Œé€‰å‡ºæœ€å¤§å€¼
            res = Math.max(res, right - left);
        }
        return res;
    }
}


```

![Alt text](image-124.png)

![Alt text](image-125.png)

```java
public class Solution {

    public int lengthOfLongestSubstringKDistinct(String s, int k) {
        int len = s.length();
        if (len <= k) {
            return len;
        }

        char[] charArray = s.toCharArray();
        int[] freq = new int[128];
        int count = 0;

        int left = 0;
        int right = 0;
        int res = k;
        while (right < len) {
            freq[charArray[right]]++;
            if (freq[charArray[right]] == 1) {
                count++;
            }
            right++;

            while (count == k + 1) {
                freq[charArray[left]]--;
                if (freq[charArray[left]] == 0) {
                    count--;
                }
                left++;
            }

            res = Math.max(res, right - left);
        }
        return res;
    }
}


```

![Alt text](image-126.png)

![Alt text](image-127.png)
```java
public class Solution {

    public int numSubarrayBoundedMax(int[] nums, int left, int right) {
        return lessEqualsThan(nums, right) - lessEqualsThan(nums, left - 1);
    }

    private int lessEqualsThan(int[] nums, int k) {
        int len = nums.length;
        int res = 0;
        // å¾ªç¯ä¸å˜é‡ï¼šnums[left..right] é‡Œçš„æ‰€æœ‰å…ƒç´ éƒ½å°äºç­‰äº k
        for (int left = 0, right = 0; right < len; right++) {
            if (nums[right] > k) {
                left = right + 1;
            }
            res += right - left;
        }
        return res;
    }
}


```
![Alt text](image-128.png)

![Alt text](image-129.png)

![Alt text](image-130.png)
```java

public class Solution {

    public int subarraysWithKDistinct(int[] A, int K) {
        return atMostKDistinct(A, K) - atMostKDistinct(A, K - 1);
    }

    /**
     * @param A
     * @param K
     * @return æœ€å¤šåŒ…å« K ä¸ªä¸åŒæ•´æ•°çš„å­åŒºé—´çš„ä¸ªæ•°
     */
    private int atMostKDistinct(int[] A, int K) {
        int len = A.length;
        int[] freq = new int[len + 1];

        int left = 0;
        int right = 0;
        // [left, right) é‡Œä¸åŒæ•´æ•°çš„ä¸ªæ•°
        int count = 0;
        int res = 0;
        // [left, right) åŒ…å«ä¸åŒæ•´æ•°çš„ä¸ªæ•°å°äºç­‰äº K
        while (right < len) {
            if (freq[A[right]] == 0) {
                count++;
            }
            freq[A[right]]++;
            right++;

            while (count > K) {
                freq[A[left]]--;
                if (freq[A[left]] == 0) {
                    count--;
                }
                left++;
            }
            // [left, right) åŒºé—´çš„é•¿åº¦å°±æ˜¯å¯¹ç»“æœçš„è´¡çŒ®
            res += right - left;
        }
        return res;
    }
}


```

![Alt text](image-131.png)


## æ»‘åŠ¨çª—å£ 4ï¼šä½¿ç”¨æ•°æ®ç»“æ„ç»´æŠ¤çª—å£æ€§è´¨
æœ‰ä¸€ç±»é—®é¢˜åªæ˜¯åå­—ä¸Šå«ã€Œæ»‘åŠ¨çª—å£ã€ï¼Œä½†è§£å†³è¿™ä¸€ç±»é—®é¢˜éœ€è¦ç”¨åˆ°å¸¸è§çš„æ•°æ®ç»“æ„ã€‚è¿™ä¸€èŠ‚ç»™å‡ºçš„é—®é¢˜å¯ä»¥å½“åšä¾‹é¢˜è¿›è¡Œå­¦ä¹ ï¼Œä¸€äº›æ¯”è¾ƒå¤æ‚çš„é—®é¢˜æ˜¯åŸºäºè¿™äº›é—®é¢˜è¡ç”Ÿå‡ºæ¥çš„ã€‚





