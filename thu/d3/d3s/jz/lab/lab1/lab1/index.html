<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../../../../../img/favicon.ico">
        <title>supervisor-rv - 勿怯 勿惰 勿贪 勿我</title>
        <link href="../../../../../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../../../../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../../../../../../css/brands.min.css" rel="stylesheet">
        <link href="../../../../../../../css/solid.min.css" rel="stylesheet">
        <link href="../../../../../../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../../../../../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../../../../../..">勿怯 勿惰 勿贪 勿我</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href="../../../../../../.." class="nav-link">个人首页</a>
                            </li>
                            <li class="nav-item">
                                <a href="../../../../../../../about/" class="nav-link">工具链接网址</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">清华</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../../../thu/" class="dropdown-item">清华</a>
</li>
                                    
<li>
    <a href="../../../../../../d1/d1/" class="dropdown-item">大一</a>
</li>
                                    
<li>
    <a href="../../../../../../d2/d2/" class="dropdown-item">大二</a>
</li>
                                    
<li>
    <a href="../../../../../d3/" class="dropdown-item">大三</a>
</li>
                                    
<li>
    <a href="../../../../../../d4/d4/" class="dropdown-item">大四</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">数学</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../../../../math/math/" class="dropdown-item">数学</a>
</li>
                                    
<li>
    <a href="../../../../../../../math/caculus/" class="dropdown-item">微积分</a>
</li>
                                    
<li>
    <a href="../../../../../../../math/linear/" class="dropdown-item">线性代数</a>
</li>
                                    
<li>
    <a href="../../../../../../../math/probability/" class="dropdown-item">概率论</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">计算机</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../../../../cs/cs/" class="dropdown-item">计算机</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">编程语言</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">C语言</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../../../../cs/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/c/c/" class="dropdown-item">C</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">C++语言</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../../../../cs/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/cpp/cpp/" class="dropdown-item">C++</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">数据结构</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../../../../cs/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/dsa/" class="dropdown-item">总述</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">操作系统</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../../../../cs/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/os/" class="dropdown-item">总述</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">计算机组成原理</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../../../../cs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/jz/" class="dropdown-item">总述</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">计算机网络</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../../../../cs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/jw/" class="dropdown-item">总述</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">金融量化</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../../../../finance/finance/" class="dropdown-item">金融</a>
</li>
                                    
<li>
    <a href="../../../../../../../finance/crypto/crypto/" class="dropdown-item">币</a>
</li>
                                    
<li>
    <a href="../../../../../../../finance/stock/stock/" class="dropdown-item">股票</a>
</li>
                                    
<li>
    <a href="../../../../../../../finance/quant/quant/" class="dropdown-item">量化</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">艺体</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../../../../art/art/" class="dropdown-item">文学</a>
</li>
                                    
<li>
    <a href="../../../../../../../art/English/english/" class="dropdown-item">英语</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">读书</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">计算机</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../../../../books/cs/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/lan/" class="dropdown-item">编程语言</a>
</li>
    </ul>
  </li>
            
<li>
    <a href="../../../../../../../books/%E4%B8%AA%E4%BA%BA%E6%88%90%E9%95%BF/gr/" class="dropdown-item">个人成长</a>
</li>
            
<li>
    <a href="../../../../../../../books/navy/zashu/" class="dropdown-item">杂书</a>
</li>
    </ul>
  </li>
                                    
<li>
    <a href="../../../../../../../art/music/" class="dropdown-item">音乐</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">生活记录</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../../../../me/dgh/" class="dropdown-item">我是谁</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2024</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../../../../me/2024/2024/" class="dropdown-item">2024年</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">8月</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../../../../me/2024/8/2024%E5%B9%B48%E6%9C%886%E6%97%A5/" class="dropdown-item">2024年8月6日</a>
</li>
            
<li>
    <a href="../../../../../../../me/2024/8/2024%E5%B9%B48%E6%9C%887%E6%97%A5/" class="dropdown-item">2024年8月7日</a>
</li>
            
<li>
    <a href="../../../../../../../me/2024/8/2024%E5%B9%B48%E6%9C%888%E6%97%A5/" class="dropdown-item">2024年8月8日</a>
</li>
            
<li>
    <a href="../../../../../../../me/2024/8/2024%E5%B9%B48%E6%9C%889%E6%97%A5/" class="dropdown-item">2024年8月9日</a>
</li>
            
<li>
    <a href="../../../../../../../me/2024/8/2024%E5%B9%B48%E6%9C%8810%E6%97%A5/" class="dropdown-item">2024年8月10日</a>
</li>
            
<li>
    <a href="../../../../../../../me/2024/8/2024%E5%B9%B48%E6%9C%8811%E6%97%A5/" class="dropdown-item">2024年8月11日</a>
</li>
            
<li>
    <a href="../../../../../../../me/2024/8/2024%E5%B9%B48%E6%9C%8812%E6%97%A5/" class="dropdown-item">2024年8月12日</a>
</li>
            
<li>
    <a href="../../../../../../../me/2024/8/2024%E5%B9%B48%E6%9C%8813%E6%97%A5/" class="dropdown-item">2024年8月13日</a>
</li>
            
<li>
    <a href="../../../../../../../me/2024/8/2024%E5%B9%B48%E6%9C%8814%E6%97%A5/" class="dropdown-item">2024年8月14日</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">11月</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../../../../me/2024/11/2024%E5%B9%B411%E6%9C%8828%E6%97%A5/" class="dropdown-item">2024年11月28日</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2025</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../../../../../me/2025/2025%E5%B9%B4/" class="dropdown-item">2025年</a>
</li>
            
<li>
    <a href="../../../../../../../me/2025/1%E6%9C%88/2025%E5%B9%B41%E6%9C%88/" class="dropdown-item">2025年1月</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#supervisor-rv" class="nav-link">supervisor-rv</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#kernel" class="nav-link">kernel</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#term" class="nav-link">term</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="1"><a href="#rv32i" class="nav-link">rv32i</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#rv32i_1" class="nav-link">RV32I 一页速查表</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#pc" class="nav-link">迷你示例：PC 相对寻址 + 条件分支</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#rv32i_2" class="nav-link">位置与作用（以 RV32I 为例）</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#_3" class="nav-link">小结</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="supervisor-rv">supervisor-rv</h1>
<p>Windows 用户可在解压缩 rv.zip 之后，从 supervisor-rv 子目录中找到监控程序，但强烈建议依据上述的 URL 获得最新版本的监控程序。</p>
<p>进入目录后，可以看到两个文件和两个目录：</p>
<p>LICENSE Apache 版权申明文件；
README.md 这个文件非常重要，务必仔细阅读，包含了监控程序的相关内容，以及需要实现的指令和格式；
kernel 这个目录包含了监控程序的代码，务必仔细阅读；
term 这个目录包含了终端程序的代码，务必仔细阅读。</p>
<h2 id="kernel">kernel</h2>
<h2 id="term">term</h2>
<h1 id="rv32i">rv32i</h1>
<p><a href="https://lab.cs.tsinghua.edu.cn/cod-lab-docs/labs/lab1/riscv-inst/">课程相关页面</a></p>
<p><img alt="alt text" src="../image.png" /></p>
<p>RV32I 里“右移”有两种：<strong>逻辑右移 SRL/SRLI</strong> 和 <strong>算术右移 SRA/SRAI</strong>。区别在于高位如何填充、以及是否保持符号。</p>
<ul>
<li>
<p><strong>SRL / SRLI（逻辑右移）</strong>
  高位<strong>补 0</strong>。不看符号位，适用于<strong>无符号数</strong>或当作位移/掩码操作。
  例：<code>0x8000_0001 SRL 1 → 0x4000_0000</code></p>
</li>
<li>
<p><strong>SRA / SRAI（算术右移）</strong>
  高位用<strong>原符号位（bit31）复制</strong>，保持数值的正负号。相当于对二补数做“除以 2 且向负无穷取整”。
  例：<code>0xFFFF_FFFD (-3) SRA 1 → 0xFFFF_FFFE (-2)</code>
  <code>0x8000_0001 SRA 1 → 0xC000_0000</code></p>
</li>
</ul>
<p>补充要点</p>
<ul>
<li><code>…I</code> 结尾的是<strong>立即数</strong>版本；寄存器版本的移位量来自 <code>rs2</code>。</li>
<li>在 <strong>RV32</strong> 中移位量只取<strong>低 5 位</strong>（0–31），更高位被忽略。</li>
<li>C 里 <code>&gt;&gt;</code> 对无符号通常对应 <strong>SRL</strong>，对有符号常实现为 <strong>SRA</strong>（但标准上曾是实现相关），在汇编里需显式选 <strong>SRL</strong> 或 <strong>SRA</strong>。</li>
</ul>
<p>下面给你一份<strong>RV32I 一页速查表</strong>（只含基础整数指令）。每行包含：<strong>助记符</strong>、<strong>类型</strong>（R/I/S/B/U/J）、<strong>编码关键字</strong>（opcode / funct3 / funct7 或说明）、<strong>语义</strong>、<strong>影响</strong>（写哪些寄存器/是否改PC；RV32I 无条件码标志位）。</p>
<hr />
<h2 id="rv32i_1">RV32I 一页速查表</h2>
<h3 id="-opcode0110011">算术/逻辑（寄存器-寄存器，<code>opcode=0110011</code>）</h3>
<table>
<thead>
<tr>
<th>指令</th>
<th>类型</th>
<th>funct7</th>
<th>funct3</th>
<th>语义</th>
<th>影响</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ADD rd,rs1,rs2</code></td>
<td>R</td>
<td><code>0000000</code></td>
<td><code>000</code></td>
<td>rd = rs1 + rs2</td>
<td>写 rd</td>
</tr>
<tr>
<td><code>SUB rd,rs1,rs2</code></td>
<td>R</td>
<td><code>0100000</code></td>
<td><code>000</code></td>
<td>rd = rs1 - rs2</td>
<td>写 rd</td>
</tr>
<tr>
<td><code>SLL rd,rs1,rs2</code></td>
<td>R</td>
<td><code>0000000</code></td>
<td><code>001</code></td>
<td>rd = rs1 &lt;&lt; (rs2[4:0])</td>
<td>写 rd</td>
</tr>
<tr>
<td><code>SLT rd,rs1,rs2</code></td>
<td>R</td>
<td><code>0000000</code></td>
<td><code>010</code></td>
<td>rd = (rs1 &lt; rs2) 有符号</td>
<td>写 rd</td>
</tr>
<tr>
<td><code>SLTU rd,rs1,rs2</code></td>
<td>R</td>
<td><code>0000000</code></td>
<td><code>011</code></td>
<td>rd = (rs1 &lt; rs2) 无符号</td>
<td>写 rd</td>
</tr>
<tr>
<td><code>XOR rd,rs1,rs2</code></td>
<td>R</td>
<td><code>0000000</code></td>
<td><code>100</code></td>
<td>rd = rs1 ^ rs2</td>
<td>写 rd</td>
</tr>
<tr>
<td><code>SRL rd,rs1,rs2</code></td>
<td>R</td>
<td><code>0000000</code></td>
<td><code>101</code></td>
<td>逻辑右移</td>
<td>写 rd</td>
</tr>
<tr>
<td><code>SRA rd,rs1,rs2</code></td>
<td>R</td>
<td><code>0100000</code></td>
<td><code>101</code></td>
<td>算术右移</td>
<td>写 rd</td>
</tr>
<tr>
<td><code>OR  rd,rs1,rs2</code></td>
<td>R</td>
<td><code>0000000</code></td>
<td><code>110</code></td>
<td>位或</td>
<td>写 rd</td>
</tr>
<tr>
<td><code>AND rd,rs1,rs2</code></td>
<td>R</td>
<td><code>0000000</code></td>
<td><code>111</code></td>
<td>位与</td>
<td>写 rd</td>
</tr>
</tbody>
</table>
<h3 id="opcode0010011">算术/逻辑立即数（<code>opcode=0010011</code>）</h3>
<table>
<thead>
<tr>
<th>指令</th>
<th>类型</th>
<th>额外字段</th>
<th>funct3</th>
<th>语义</th>
<th>影响</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ADDI rd,rs1,imm12</code></td>
<td>I</td>
<td>—</td>
<td><code>000</code></td>
<td>rd = rs1 + imm</td>
<td>写 rd</td>
</tr>
<tr>
<td><code>SLTI rd,rs1,imm12</code></td>
<td>I</td>
<td>—</td>
<td><code>010</code></td>
<td>rd = (rs1 &lt; imm) 有符号</td>
<td>写 rd</td>
</tr>
<tr>
<td><code>SLTIU rd,rs1,imm12</code></td>
<td>I</td>
<td>—</td>
<td><code>011</code></td>
<td>rd = (rs1 &lt; imm) 无符号</td>
<td>写 rd</td>
</tr>
<tr>
<td><code>XORI rd,rs1,imm12</code></td>
<td>I</td>
<td>—</td>
<td><code>100</code></td>
<td>rd = rs1 ^ imm</td>
<td>写 rd</td>
</tr>
<tr>
<td><code>ORI  rd,rs1,imm12</code></td>
<td>I</td>
<td>—</td>
<td><code>110</code></td>
<td>rd = rs1 | imm</td>
<td>写 rd</td>
</tr>
<tr>
<td><code>ANDI rd,rs1,imm12</code></td>
<td>I</td>
<td>—</td>
<td><code>111</code></td>
<td>rd = rs1 &amp; imm</td>
<td>写 rd</td>
</tr>
<tr>
<td><code>SLLI rd,rs1,shamt</code></td>
<td>I</td>
<td><code>funct7=0000000</code></td>
<td><code>001</code></td>
<td>左移 shamt(0–31)</td>
<td>写 rd</td>
</tr>
<tr>
<td><code>SRLI rd,rs1,shamt</code></td>
<td>I</td>
<td><code>funct7=0000000</code></td>
<td><code>101</code></td>
<td>逻辑右移</td>
<td>写 rd</td>
</tr>
<tr>
<td><code>SRAI rd,rs1,shamt</code></td>
<td>I</td>
<td><code>funct7=0100000</code></td>
<td><code>101</code></td>
<td>算术右移</td>
<td>写 rd</td>
</tr>
</tbody>
</table>
<h3 id="opcode0000011">载入（<code>opcode=0000011</code>）</h3>
<table>
<thead>
<tr>
<th>指令</th>
<th>类型</th>
<th>funct3</th>
<th>语义（地址 = rs1 + imm12）</th>
<th>影响</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>LB  rd,imm(rs1)</code></td>
<td>I</td>
<td><code>000</code></td>
<td>读 8 位，符号扩展到 32</td>
<td>写 rd</td>
</tr>
<tr>
<td><code>LH  rd,imm(rs1)</code></td>
<td>I</td>
<td><code>001</code></td>
<td>读 16 位，符号扩展</td>
<td>写 rd</td>
</tr>
<tr>
<td><code>LW  rd,imm(rs1)</code></td>
<td>I</td>
<td><code>010</code></td>
<td>读 32 位</td>
<td>写 rd</td>
</tr>
<tr>
<td><code>LBU rd,imm(rs1)</code></td>
<td>I</td>
<td><code>100</code></td>
<td>读 8 位，无符号零扩展</td>
<td>写 rd</td>
</tr>
<tr>
<td><code>LHU rd,imm(rs1)</code></td>
<td>I</td>
<td><code>101</code></td>
<td>读 16 位，无符号零扩展</td>
<td>写 rd</td>
</tr>
</tbody>
</table>
<h3 id="opcode0100011">存储（<code>opcode=0100011</code>）</h3>
<table>
<thead>
<tr>
<th>指令</th>
<th>类型</th>
<th>funct3</th>
<th>语义（地址 = rs1 + imm12[分裂成 S 型]）</th>
<th>影响</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>SB rs2,imm(rs1)</code></td>
<td>S</td>
<td><code>000</code></td>
<td>写 rs2[7:0]</td>
<td>内存</td>
</tr>
<tr>
<td><code>SH rs2,imm(rs1)</code></td>
<td>S</td>
<td><code>001</code></td>
<td>写 rs2[15:0]</td>
<td>内存</td>
</tr>
<tr>
<td><code>SW rs2,imm(rs1)</code></td>
<td>S</td>
<td><code>010</code></td>
<td>写 rs2[31:0]</td>
<td>内存</td>
</tr>
</tbody>
</table>
<h3 id="_1">跳转/分支</h3>
<table>
<thead>
<tr>
<th>指令</th>
<th>类型</th>
<th>opcode</th>
<th>funct3</th>
<th>语义</th>
<th>影响</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>JAL rd,offset</code></td>
<td>J</td>
<td><code>1101111</code></td>
<td>—</td>
<td>rd = pc+4；pc += signext(offset)</td>
<td>写 rd、改 PC</td>
</tr>
<tr>
<td><code>JALR rd,rs1,imm</code></td>
<td>I</td>
<td><code>1100111</code></td>
<td><code>000</code></td>
<td>t = (rs1+imm)&amp;\~1；rd = pc+4；pc = t</td>
<td>写 rd、改 PC</td>
</tr>
<tr>
<td><code>BEQ rs1,rs2,off</code></td>
<td>B</td>
<td><code>1100011</code></td>
<td><code>000</code></td>
<td>rs1==rs2 则 pc += off</td>
<td>改 PC</td>
</tr>
<tr>
<td><code>BNE rs1,rs2,off</code></td>
<td>B</td>
<td><code>1100011</code></td>
<td><code>001</code></td>
<td>不等则跳</td>
<td>改 PC</td>
</tr>
<tr>
<td><code>BLT rs1,rs2,off</code></td>
<td>B</td>
<td><code>1100011</code></td>
<td><code>100</code></td>
<td>有符号 &lt; 则跳</td>
<td>改 PC</td>
</tr>
<tr>
<td><code>BGE rs1,rs2,off</code></td>
<td>B</td>
<td><code>1100011</code></td>
<td><code>101</code></td>
<td>有符号 ≥ 则跳</td>
<td>改 PC</td>
</tr>
<tr>
<td><code>BLTU rs1,rs2,off</code></td>
<td>B</td>
<td><code>1100011</code></td>
<td><code>110</code></td>
<td>无符号 &lt; 则跳</td>
<td>改 PC</td>
</tr>
<tr>
<td><code>BGEU rs1,rs2,off</code></td>
<td>B</td>
<td><code>1100011</code></td>
<td><code>111</code></td>
<td>无符号 ≥ 则跳</td>
<td>改 PC</td>
</tr>
</tbody>
</table>
<h3 id="pc-u">立即数装入/PC 相对（U 型）</h3>
<table>
<thead>
<tr>
<th>指令</th>
<th>类型</th>
<th>opcode</th>
<th>语义</th>
<th>影响</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>LUI rd,imm20</code></td>
<td>U</td>
<td><code>0110111</code></td>
<td>rd = imm20 &lt;&lt; 12</td>
<td>写 rd</td>
</tr>
<tr>
<td><code>AUIPC rd,imm20</code></td>
<td>U</td>
<td><code>0010111</code></td>
<td>rd = pc + (imm20 &lt;&lt; 12)</td>
<td>写 rd</td>
</tr>
</tbody>
</table>
<h3 id="_2">杂项 / 屏障 / 系统</h3>
<table>
<thead>
<tr>
<th>指令</th>
<th>类型</th>
<th>opcode</th>
<th>funct3</th>
<th>语义</th>
<th>影响</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>FENCE pred,succ</code></td>
<td>I</td>
<td><code>0001111</code></td>
<td><code>000</code></td>
<td>内存屏障（次序约束）</td>
<td>无寄存器；顺序影响</td>
<td></td>
</tr>
<tr>
<td><code>FENCE.I</code></td>
<td>I</td>
<td><code>0001111</code></td>
<td><code>001</code></td>
<td>指令取指与数据可见性同步</td>
<td>无寄存器</td>
<td></td>
</tr>
<tr>
<td><code>ECALL</code></td>
<td>I</td>
<td><code>1110011</code></td>
<td><code>000</code></td>
<td>环境调用</td>
<td>进入环境；PC 转移</td>
<td></td>
</tr>
<tr>
<td><code>EBREAK</code></td>
<td>I</td>
<td><code>1110011</code></td>
<td><code>000</code></td>
<td>断点</td>
<td>进入调试；PC 转移</td>
<td></td>
</tr>
<tr>
<td><code>CSRRW rd,csr,rs1</code></td>
<td>I</td>
<td><code>1110011</code></td>
<td><code>001</code></td>
<td>交换：t=CSR; CSR=rs1; rd=t</td>
<td>写 rd/CSR</td>
<td></td>
</tr>
<tr>
<td><code>CSRRS rd,csr,rs1</code></td>
<td>I</td>
<td><code>1110011</code></td>
<td><code>010</code></td>
<td>读并置位：CSR</td>
<td>= rs1</td>
<td>写 rd/CSR</td>
</tr>
<tr>
<td><code>CSRRC rd,csr,rs1</code></td>
<td>I</td>
<td><code>1110011</code></td>
<td><code>011</code></td>
<td>读并清位：CSR &amp;= \~rs1</td>
<td>写 rd/CSR</td>
<td></td>
</tr>
<tr>
<td><code>CSRRWI rd,csr,uimm</code></td>
<td>I</td>
<td><code>1110011</code></td>
<td><code>101</code></td>
<td>立即数版本（写 CSR=uimm）</td>
<td>写 rd/CSR</td>
<td></td>
</tr>
<tr>
<td><code>CSRRSI rd,csr,uimm</code></td>
<td>I</td>
<td><code>1110011</code></td>
<td><code>110</code></td>
<td>立即数置位</td>
<td>写 rd/CSR</td>
<td></td>
</tr>
<tr>
<td><code>CSRRCI rd,csr,uimm</code></td>
<td>I</td>
<td><code>1110011</code></td>
<td><code>111</code></td>
<td>立即数清位</td>
<td>写 rd/CSR</td>
<td></td>
</tr>
</tbody>
</table>
<blockquote>
<p>备注</p>
<ul>
<li><code>x0</code> 恒为 0；对 <code>rd=x0</code> 的写入被丢弃。</li>
<li>RV32I <strong>没有条件码标志位</strong>（ZF、CF 等都不存在）；所有比较通过结果寄存器或分支立即判断完成。</li>
<li>立即数字段：I/S/B 为 12 位有符号；U/J 为 20 位（拼接时按各自编码位布局）；移位量 <code>shamt</code> 为 5 位。</li>
<li>分支/跳转位移按 2 字节对齐（最低位为 0）。</li>
</ul>
</blockquote>
<hr />
<h2 id="pc">迷你示例：PC 相对寻址 + 条件分支</h2>
<pre><code class="language-asm">    # 以 AUIPC 做基址 + LW 读常量表
    AUIPC  a0, %pcrel_hi(table)   # a0 = pc + hi20(table-pc)
    LW     t0, %pcrel_lo(table)(a0) # t0 = *(a0 + lo12)
    ADDI   t1, x0, 100
    BLT    t0, t1, less            # if t0 &lt; 100 跳转
    ADDI   a1, x0, 1               # not less
    J      done
less:
    ADDI   a1, x0, -1
done:
    EBREAK

table:
    .word 42
</code></pre>
<p>如果你希望，我也可以把这份速查表导出成 <strong>A4/PDF</strong>（带更紧凑排版与页眉页脚），或者按你日常使用的寄存器别名（<code>a0–a7, t0–t6, s0–s11</code>）再补一张寄存器速查。</p>
<h2 id="rv32i_2">位置与作用（以 RV32I 为例）</h2>
<p>简短说：</p>
<ul>
<li><strong>opcode</strong>：7 位“主操作码”，在指令最低位 <code>[6:0]</code>。它先决定<strong>指令格式</strong>（R/I/S/B/U/J 之一）和大类（如“寄寄算术”“载入”“存储”“分支”“系统”等）。</li>
<li><strong>funct3</strong>：3 位“功能码”，在 <code>[14:12]</code>。在同一个 opcode 之下进一步区分<strong>具体子操作</strong>（如分支条件、载入/存储数据宽度、算术/逻辑是哪一种等）。</li>
<li><strong>funct7</strong>：7 位“功能码”，在最高位 <code>[31:25]</code>。在某些 R 型/移位类指令里再细分操作（比如 ADD vs SUB、SRL vs SRA）。很多非 R 型指令把这 7 位拿去做立即数的一部分，因此<strong>并不总是存在</strong>“funct7”的意义。</li>
</ul>
<hr />
<h3 id="r-">R 型（寄存器-寄存器算术）</h3>
<pre><code>31        25 24  20 19  15 14  12 11   7 6      0
[ funct7   ][ rs2 ][ rs1 ][funct3][ rd ][ opcode]
</code></pre>
<ul>
<li><code>opcode=0110011</code> 表示“整数寄寄运算”。</li>
<li>
<p><code>funct3</code> 指出是哪一组操作；<code>funct7</code> 再细分：</p>
</li>
<li>
<p><code>ADD</code>：funct7=<code>0000000</code>、funct3=<code>000</code></p>
</li>
<li><code>SUB</code>：funct7=<code>0100000</code>、funct3=<code>000</code>（与 ADD 仅 funct7 不同）</li>
<li><code>SRL</code>：funct7=<code>0000000</code>、funct3=<code>101</code></li>
<li><code>SRA</code>：funct7=<code>0100000</code>、funct3=<code>101</code></li>
</ul>
<h3 id="i-jalr-csr">I 型（算术立即数 / 载入 / JALR / CSR）</h3>
<pre><code>31           20 19  15 14  12 11   7 6      0
[   imm[11:0]  ][ rs1 ][funct3][ rd ][ opcode]
</code></pre>
<ul>
<li>这里没有 funct7，这些高位是<strong>立即数</strong>。</li>
<li><code>opcode=0010011</code>（算术立即数）时，<code>funct3</code> 区分操作：<code>000</code>=ADDI，<code>110</code>=ORI，<code>111</code>=ANDI 等；</li>
<li>移位立即数用 <code>funct3=001/101</code> 再用“伪 funct7”位区分：<code>0000000</code>=SLLI/SRLI，<code>0100000</code>=SRAI。</li>
<li><code>opcode=0000011</code>（载入）时，<code>funct3</code> 指定宽度：<code>000</code>=LB，<code>001</code>=LH，<code>010</code>=LW，<code>100</code>=LBU，<code>101</code>=LHU。</li>
<li><code>opcode=1100111</code>（JALR）固定 <code>funct3=000</code>。</li>
<li><code>opcode=1110011</code>（系统/CSR）时，<code>funct3</code> 区分 CSRRW/CSRRS/CSRRC 以及它们的立即数版本。</li>
</ul>
<h3 id="s">S 型（存储）</h3>
<pre><code>31   25 24  20 19  15 14  12 11   7 6      0
[imm[11:5]][ rs2 ][ rs1 ][funct3][imm[4:0]][opcode]
</code></pre>
<ul>
<li><code>opcode=0100011</code>；<code>funct3</code> 指定宽度：<code>000</code>=SB，<code>001</code>=SH，<code>010</code>=SW。</li>
</ul>
<h3 id="b">B 型（条件分支）</h3>
<pre><code>31   30  25 24  20 19  15 14  12 11   8 7    6 6      0
[imm[12|10:5]][ rs2 ][ rs1 ][funct3][imm[4:1|11]][opcode]
</code></pre>
<ul>
<li><code>opcode=1100011</code>；<code>funct3</code> 指定条件：<code>000</code>=BEQ，<code>001</code>=BNE，<code>100</code>=BLT，<code>101</code>=BGE，<code>110</code>=BLTU，<code>111</code>=BGEU。</li>
</ul>
<h3 id="uj">U/J 型（高位立即数 / 立即跳转）</h3>
<pre><code>U: 31           12 11   7 6      0      J: 31 30 21 20 19   12 11   7 6      0
   [   imm[31:12]  ][ rd ][ opcode]        [imm[20|10:1|11|19:12]][ rd ][opcode]
</code></pre>
<ul>
<li>没有 funct3/funct7。</li>
<li><code>LUI</code> <code>opcode=0110111</code>，<code>AUIPC</code> <code>opcode=0010111</code>；<code>JAL</code> <code>opcode=1101111</code>。</li>
</ul>
<hr />
<h2 id="_3">小结</h2>
<ul>
<li><strong>opcode</strong>：决定“这是一大类什么指令 + 用什么格式解码”。</li>
<li><strong>funct3 / funct7</strong>：在该大类下<strong>精确到哪条具体指令</strong>；R 型大量使用两者组合；其它格式多用 <code>funct3</code>，高位则用于立即数。</li>
<li>它们三者一起构成了解码表的关键字段：<strong>同一 opcode + funct3 +（可选）funct7</strong> ≈ 一条唯一的指令。</li>
</ul></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../../../../../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../../../../../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../../../../../js/base.js"></script>
        <script src="../../../../../../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
